

<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>dojox.form.Uploader &mdash; The Dojo Toolkit - Reference Guide</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="The Dojo Toolkit - Reference Guide" href="../../index.html" />
    <link rel="up" title="DojoX" href="../contents.html" />
    <link rel="next" title="dojox.form.ValidationTextarea" href="ValidationTextarea.html" />
    <link rel="prev" title="dojox.form.TimeSpinner" href="TimeSpinner.html" />

    <link rel="stylesheet" href="../../_static/css/site.css">
    <link rel="stylesheet" href="../../_static/js/docs/resources/guide.css">
	<script type="text/javascript">
		dojoConfig = {
			async: true
		};
	</script>
    <script type="text/javascript" src="../../_static/js/dojo/dojo.js"></script>
    <script type="text/javascript" src="../../_static/js/docs/guide.js"></script>

  </head>
  <body>  

    <div class="document">
    <div id="accessibilityNode">
        <a href="#intro">Skip to Content</a> | <a href="#nav">Skip to Navigation</a>
    </div>
    <hr class="hide">
    <div id="page" class="docPage">
        <div id="header">
            <div class="container">
                <span id="logo"><a title="Home" href="http://dojotoolkit.org">
                    <img alt="Dojo Toolkit" src="../../_static/images/logo.png"></a>
                </span>
                <ul id="navigation">
                    <li class="home"><a href="/"><span class="homeIcon"></span></a></li>
                    <li class="download"><a href="/download/">Download</a></li>
                    <li class="features"><a href="/features/">Features</a></li>
                    <li class="docs active"><a href="/documentation/">Documentation</a></li>
                    <li class="community"><a href="/community/">Community</a></li>
                    <li class="about"><a href="/blog/">Blog</a></li>
                </ul>
            </div>
        </div>
    
        <hr class="hide" />
    
        <div id="main">
            <div id="content" class="innerBox">
                <div class="pageTitleContainer">
                    <h1>Documentation</h1>
                    <ul class="subnav">
                        <li><a href="/documentation/"><span>Tutorials</span></a></li>
                        <li class="active"><a href="/reference-guide/"><span>Reference Guide</span></a></li>
                        <li><a href="/api/"><span>API Documentation</span></a></li>
                    </ul>
                </div>
                <div class="line">
                    <div class="unit size3of4 firstUnit">
                        <div class="spacer">
                            
  <div class="section" id="dojox-form-uploader">
<span id="id1"></span><h1><a class="toc-backref" href="#id2">dojox.form.Uploader</a><a class="headerlink" href="#dojox-form-uploader" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Project owner:</th><td class="field-body">Mike Wilcox</td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">Mike Wilcox</td>
</tr>
<tr class="field-odd field"><th class="field-name">since:</th><td class="field-body">1.6</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#dojox-form-uploader" id="id2">dojox.form.Uploader</a><ul>
<li><a class="reference internal" href="#features" id="id3">Features</a><ul>
<li><a class="reference internal" href="#important-amd-note" id="id4">Important AMD Note</a></li>
<li><a class="reference internal" href="#important-form-note" id="id5">Important Form Note</a></li>
<li><a class="reference internal" href="#missing-features" id="id6">Missing Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id7">Usage</a><ul>
<li><a class="reference internal" href="#uploader-without-plugins" id="id8">Uploader without Plugins</a></li>
<li><a class="reference internal" href="#uploader-with-the-html5-plugin" id="id9">Uploader with the HTML5 Plugin</a></li>
<li><a class="reference internal" href="#uploader-with-the-iframe-plugin" id="id10">Uploader with the IFrame Plugin</a></li>
<li><a class="reference internal" href="#uploader-with-the-flash-plugin" id="id11">Uploader with the Flash Plugin</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setup" id="id12">Setup</a><ul>
<li><a class="reference internal" href="#markup" id="id13">Markup</a></li>
<li><a class="reference internal" href="#programmatic" id="id14">Programmatic</a></li>
<li><a class="reference internal" href="#the-name-property" id="id15">The &#8220;name&#8221; Property</a></li>
<li><a class="reference internal" href="#other-properties" id="id16">Other Properties</a></li>
<li><a class="reference internal" href="#methods" id="id17">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#server-side" id="id18">Server Side</a><ul>
<li><a class="reference internal" href="#server-side-code-php" id="id19">Server Side Code PHP</a></li>
<li><a class="reference internal" href="#server-side-return-data" id="id20">Server Side Return Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id21">Examples</a></li>
</ul>
</li>
</ul>
</div>
<p>A widget that adds functionality to a standard HTML file input which allows file uploading to a server. The widget hides the actual uploader and substitutes a dijit.form.Button, so that the file input matches the rest of the user interface. If the browser supports the HTML5 file input specification, that functionality is used. If it is not supported (IE or older browsers) plugins are available to enhance the Uploader.</p>
<p><strong>The dojox.form.Uploader is an improvement upon, and replaces the dojox.form.FileUploader</strong>. The multiple problems created by Flash are avoided because it is not used in Mozilla and Webkit browsers. Support for FileUploader will cease as of 1.6, but the code will remain until 2.0 for backwards compatibility.</p>
<div class="section" id="features">
<h2><a class="toc-backref" href="#id3">Features</a><a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li>The Uploader is a Dijit, and supports all the same functionality as any other form widget. FileUploader made this claim, but it still had trouble due to its late build process and dependency on the Flash plugin.</li>
<li>The Uploader may be placed in a form and will &#8220;just work&#8221;. Actually, the Uploader will block the form&#8217;s submit event and take over its duties of collecting the field values and uploading the data to the server using the form&#8217;s action attribute, or the url property given to the Uploader.</li>
<li>The tabIndex attribute is supported.</li>
<li>An additional widget, dojox.form.uploader.FileList is provided to show the selection set and visualize the upload progress.</li>
<li><a class="reference internal" href="uploader/FileList.html#dojox-form-uploader-filelist"><em>dojox.form.uploader.FileList</em></a></li>
</ul>
</div></blockquote>
<div class="section" id="important-amd-note">
<h3><a class="toc-backref" href="#id4">Important AMD Note</a><a class="headerlink" href="#important-amd-note" title="Permalink to this headline">¶</a></h3>
<p>When using the Uploader programmatically, you cannot use the reference argument from require() - you must use the global. This is because the plugins redefine the original Uploader class, and AMD does not allow time for this to happen. In other this will NOT work:</p>
<div class="highlight"><pre><span class="nx">require</span><span class="p">([</span><span class="s1">&#39;dojox/form/Uploader&#39;</span><span class="p">,</span> <span class="s1">&#39;dojox/form/uploader/plugins/Flash&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Uploader</span><span class="p">){</span>
    <span class="nx">myUploader</span> <span class="o">=</span> <span class="nx">Uploader</span><span class="p">(...);</span>
<span class="p">});</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="javascript"><textarea style="display:none">require(['dojox/form/Uploader', 'dojox/form/uploader/plugins/Flash'], function(Uploader){
    myUploader = Uploader(...);
});</textarea></div><p>Until 2.0, you must use:</p>
<div class="highlight"><pre><span class="nx">require</span><span class="p">([</span><span class="s1">&#39;dojox/form/Uploader&#39;</span><span class="p">,</span> <span class="s1">&#39;dojox/form/uploader/plugins/Flash&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Uploader</span><span class="p">){</span>
    <span class="nx">myUploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">Uploader</span><span class="p">(...);</span> <span class="c1">// disregard reference argument</span>
<span class="p">});</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="javascript"><textarea style="display:none">require(['dojox/form/Uploader', 'dojox/form/uploader/plugins/Flash'], function(Uploader){
    myUploader = new dojox.form.Uploader(...); // disregard reference argument
});</textarea></div></div>
<div class="section" id="important-form-note">
<h3><a class="toc-backref" href="#id5">Important Form Note</a><a class="headerlink" href="#important-form-note" title="Permalink to this headline">¶</a></h3>
<p>Because the Uploader uses your existing form, you must set its <em>enctype</em> to &#8220;multipart/form-data&#8221; which is used for uploading files.</p>
</div>
<div class="section" id="missing-features">
<h3><a class="toc-backref" href="#id6">Missing Features</a><a class="headerlink" href="#missing-features" title="Permalink to this headline">¶</a></h3>
<p>The Uploader mimics the functionality of HTML5 file inputs, so some features available in the FileUploader are not (yet) available in Uploader. Specifically missing is the ability to add remove files from a current selection set. There are plans to implement this functionality soon.</p>
<p>File mask (restricting the selection to certain file types) is in the HTML5 spec but missing from browser functionality. It is not supported.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id7">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The Uploader can be used in several variations.</p>
<div class="section" id="uploader-without-plugins">
<h3><a class="toc-backref" href="#id8">Uploader without Plugins</a><a class="headerlink" href="#uploader-without-plugins" title="Permalink to this headline">¶</a></h3>
<p>The Uploader with no plugins is in &#8220;Form&#8221; mode. This mode will not do an Ajax upload. It is expected that you plan to handle the upload yourself, whether via Ajax or changing the entire page via a POST. Only form POSTs will work and they will navigate to the UploadFile.php page in the test files. Multiple file selection is used in browsers that support it, and in the others, multiple selections are added one at a time by adding file inputs.</p>
</div>
<div class="section" id="uploader-with-the-html5-plugin">
<h3><a class="toc-backref" href="#id9">Uploader with the HTML5 Plugin</a><a class="headerlink" href="#uploader-with-the-html5-plugin" title="Permalink to this headline">¶</a></h3>
<p>The HTML5 Uploader plugin does not support IE, it is more of a base class for IFrame or Flash, or used in cases where IE is not a requirement. For HTML5-capable browsers, this plugin provides an Ajax upload.</p>
</div>
<div class="section" id="uploader-with-the-iframe-plugin">
<h3><a class="toc-backref" href="#id10">Uploader with the IFrame Plugin</a><a class="headerlink" href="#uploader-with-the-iframe-plugin" title="Permalink to this headline">¶</a></h3>
<p>The IFrame plugin will use the IFrame to upload in IE. All other browsers will use the HTML5 plugin unless <em>force=&#8221;iframe&#8221;</em> is used.</p>
</div>
<div class="section" id="uploader-with-the-flash-plugin">
<h3><a class="toc-backref" href="#id11">Uploader with the Flash Plugin</a><a class="headerlink" href="#uploader-with-the-flash-plugin" title="Permalink to this headline">¶</a></h3>
<p>The Flash plugin will use a SWF to upload in non-HTML5 browsers. All other browsers will use the HTML5 plugin, unless <em>force=&#8221;flash&#8221;</em> is used, then Flash will be used in all browsers. <em>force=&#8221;flash&#8221;</em> is provided because Flash has some features that HTML5 does not yet have. But it is still not recommended because of the many problems that Mozilla and Webkit have with the Flash plugin:</p>
<blockquote>
<div><ul class="simple">
<li>Changing the display style on the DOM element that holds a SWF will reset the SWF. This makes it difficult to support Flash in Dijit Tabs and Dialog boxes.</li>
<li>Initialization of a SWF is not always consistent and occasionally throws errors.</li>
<li>HTTPS support in Mozilla is problematic.</li>
</ul>
</div></blockquote>
<p>These problems do not occur in IE.</p>
</div>
</div>
<div class="section" id="setup">
<h2><a class="toc-backref" href="#id12">Setup</a><a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<div class="section" id="markup">
<h3><a class="toc-backref" href="#id13">Markup</a><a class="headerlink" href="#markup" title="Permalink to this headline">¶</a></h3>
<p>To use the Uploader, simply require it and use the appropriate data-dojo-type in an input within a form:</p>
<div class="highlight"><pre><span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.form.Uploader&quot;</span><span class="p">);</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="javascript"><textarea style="display:none">dojo.require(&quot;dojox.form.Uploader&quot;);</textarea></div><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">action=</span><span class="s">&quot;UploadFile.php&quot;</span> <span class="na">id=</span><span class="s">&quot;myForm&quot;</span> <span class="na">enctype=</span><span class="s">&quot;multipart/form-data&quot;</span> <span class="nt">&gt;</span>
   <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">&quot;uploadedfile&quot;</span> <span class="na">multiple=</span><span class="s">&quot;true&quot;</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">data-dojo-type=</span><span class="s">&quot;dojox.form.Uploader&quot;</span> <span class="na">label=</span><span class="s">&quot;Select Some Files&quot;</span> <span class="na">id=</span><span class="s">&quot;uploader&quot;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">label=</span><span class="s">&quot;Submit&quot;</span> <span class="na">data-dojo-type=</span><span class="s">&quot;dijit.form.Button&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="html"><textarea style="display:none">&lt;form method=&quot;post&quot; action=&quot;UploadFile.php&quot; id=&quot;myForm&quot; enctype=&quot;multipart/form-data&quot; &gt;
   &lt;input name=&quot;uploadedfile&quot; multiple=&quot;true&quot; type=&quot;file&quot; data-dojo-type=&quot;dojox.form.Uploader&quot; label=&quot;Select Some Files&quot; id=&quot;uploader&quot; /&gt;
   &lt;input type=&quot;submit&quot; label=&quot;Submit&quot; data-dojo-type=&quot;dijit.form.Button&quot; /&gt;
&lt;/form&gt;</textarea></div><p>Plugins will self initialize, so to use one, all that is needed is to require it. The following example uses the IFrame plugin, which inherits from the HTML5 plugin. So HTML5 file inputs are used when available and the IFrame technique used elsewhere (the HTML is exactly the same as the previous example):</p>
<div class="highlight"><pre><span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.form.Uploader&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.form.uploader.plugins.IFrame&quot;</span><span class="p">);</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="javascript"><textarea style="display:none">dojo.require(&quot;dojox.form.Uploader&quot;);
dojo.require(&quot;dojox.form.uploader.plugins.IFrame&quot;);</textarea></div><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">action=</span><span class="s">&quot;UploadFile.php&quot;</span> <span class="na">id=</span><span class="s">&quot;myForm&quot;</span> <span class="na">enctype=</span><span class="s">&quot;multipart/form-data&quot;</span> <span class="nt">&gt;</span>
   <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">&quot;uploadedfile&quot;</span> <span class="na">multiple=</span><span class="s">&quot;true&quot;</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">data-dojo-type=</span><span class="s">&quot;dojox.form.Uploader&quot;</span> <span class="na">label=</span><span class="s">&quot;Select Some Files&quot;</span> <span class="na">id=</span><span class="s">&quot;uploader&quot;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">label=</span><span class="s">&quot;Submit&quot;</span> <span class="na">data-dojo-type=</span><span class="s">&quot;dijit.form.Button&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="html"><textarea style="display:none">&lt;form method=&quot;post&quot; action=&quot;UploadFile.php&quot; id=&quot;myForm&quot; enctype=&quot;multipart/form-data&quot; &gt;
   &lt;input name=&quot;uploadedfile&quot; multiple=&quot;true&quot; type=&quot;file&quot; data-dojo-type=&quot;dojox.form.Uploader&quot; label=&quot;Select Some Files&quot; id=&quot;uploader&quot; /&gt;
   &lt;input type=&quot;submit&quot; label=&quot;Submit&quot; data-dojo-type=&quot;dijit.form.Button&quot; /&gt;
&lt;/form&gt;</textarea></div></div>
<div class="section" id="programmatic">
<h3><a class="toc-backref" href="#id14">Programmatic</a><a class="headerlink" href="#programmatic" title="Permalink to this headline">¶</a></h3>
<p>Programmatic creation is also supported as shown in the following example that includes the Flash plugin:</p>
<div class="highlight"><pre><span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.form.Uploader&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.form.uploader.plugins.Flash&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">u</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">Uploader</span><span class="p">({</span><span class="nx">label</span><span class="o">:</span><span class="s2">&quot;Programmatic Uploader&quot;</span><span class="p">,</span> <span class="nx">multiple</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="nx">uploadOnSelect</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span><span class="s2">&quot;UploadFile.php&quot;</span><span class="p">});</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">byId</span><span class="p">(</span><span class="s2">&quot;myDiv&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">domNode</span><span class="p">);</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="javascript"><textarea style="display:none">dojo.require(&quot;dojox.form.Uploader&quot;);
dojo.require(&quot;dojox.form.uploader.plugins.Flash&quot;);

var u = new dojox.form.Uploader({label:&quot;Programmatic Uploader&quot;, multiple:true, uploadOnSelect:true, url:&quot;UploadFile.php&quot;});
dojo.byId(&quot;myDiv&quot;).appendChild(u.domNode);</textarea></div></div>
<div class="section" id="the-name-property">
<h3><a class="toc-backref" href="#id15">The &#8220;name&#8221; Property</a><a class="headerlink" href="#the-name-property" title="Permalink to this headline">¶</a></h3>
<p>A key property to the Uploader is &#8220;name&#8221;, which is subsequently used as the name attribute on the file input that is created, or as the field name that Flash assigns to each file. The default name is &#8220;uploadedfile&#8221; which works with the provided <em>UploadFile.php</em>. The HTML5 spec specifies that attributes that are array-like should use square brackets at the end of the field name. If a HTMl5-capable browser is used, the Uploader appends these brackets. It also appends an &#8220;s&#8221; at the end to help the server script determine the file data. If the Flash plugin is in use, the Uploader appends &#8220;Flash&#8221; to the end of the name, or whatever the &#8220;flashFieldName&#8221; property is set to. If a standard file input is in use (in &#8220;Form&#8221; mode or IFrame), the name is left as-is.</p>
<p>The variations of the <em>name</em> attribute is necessary so that the server page knows what is being sent and can handle it appropriately.</p>
</div>
<div class="section" id="other-properties">
<h3><a class="toc-backref" href="#id16">Other Properties</a><a class="headerlink" href="#other-properties" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><strong>flashFieldName</strong> Is the text appended to the <em>name</em> property. This is necessary so the server can tell what type of file data it is dealing with.</li>
<li><strong>multiple</strong> Whether multiple files can or cannot be selected.</li>
<li><strong>url</strong> If you don&#8217;t supply an <em>action</em> in your form, supply an <em>url</em> to upload to.</li>
<li><strong>label</strong> The text used in the button.</li>
<li><strong>tabIndex</strong> Defaults to &#8220;0&#8221;. You change this to change the tab order on the page.</li>
</ul>
</div></blockquote>
<p>The Flash plugin has other properties specific to that file.</p>
</div>
<div class="section" id="methods">
<h3><a class="toc-backref" href="#id17">Methods</a><a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h3>
<p>Because the Uploader without plugins doesn&#8217;t upload, there are only the following methods:</p>
<blockquote>
<div><ul class="simple">
<li><strong>reset</strong> Clears the list of selected files.</li>
<li><strong>getFileList</strong> Returns an array of objects representing the file data.</li>
</ul>
</div></blockquote>
<p>When using a plugin, the following methods will be available:</p>
<blockquote>
<div><ul class="simple">
<li><strong>upload</strong> This method uploads the files and any data passed as an argument.</li>
<li><strong>submit</strong> This method uploads the files and if a form element is passed as an argument, it is converted into a JavaScript object.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="server-side">
<h2><a class="toc-backref" href="#id18">Server Side</a><a class="headerlink" href="#server-side" title="Permalink to this headline">¶</a></h2>
<p>The file data is uploaded to a temp folder on the server. It&#8217;s a misconception that your server side language has something to do with this. Receiving an uploaded file is handled by your server, meaning Apache or IIS. Typically the file is placed in a temp folder and it is your job to move it from there to the upload destination. Whether HTML or Flash, the payload is done with a multipart transfer. After the upload is complete, the server script is called.</p>
<p>During a Flash multi-file upload, the images are uploaded in parallel (unless deferredUploading=true), however, the server script only receives one file at a time. So if five files are uploaded, the server script will be called five times.</p>
<p>During an HTML multi-file upload, the files are all uploaded at once, and after all five are completely uploaded to the temp folder, the server script is called just once. For traditional HTML (Form mode or IFrame plugin) each file will be referenced as numerically sequenced fields: uploadedfile0, uploadedfile1, uploadedfile2, etc. For HTML5 uploads, the server script looks for &#8220;uploadedfiles&#8221; (with an &#8220;s&#8221;). the Uploader also added square brackets to the name (&#8220;uploadedfiles[]&#8221;) to match the spec. The result is the files are given to the server script as an actual array.</p>
<p>With a multipart request the POST data is the contents for the first part and the uploaded files is an array (or an object) of each additional part. Refer to your particular server documentation for how to reference the files (PHP is used as an example in the next section).</p>
<p>The return data needs to be formatted very specifically, and there are different formats for Flash and HTML. See <strong>Server Side Return Data</strong> below.</p>
<div class="section" id="server-side-code-php">
<h3><a class="toc-backref" href="#id19">Server Side Code PHP</a><a class="headerlink" href="#server-side-code-php" title="Permalink to this headline">¶</a></h3>
<p>Uploader comes with a working PHP file, <em>dojox/form/tests/UploadFile.php</em>, to use as a reference for how your server side code should work. UploadFile.php has two dependencies, <em>dojo/tests/resources/JSON.php</em>, which is used for converting the return data to a JSON string, and <em>dojox/form/tests/cLog.php</em> which is used to log message to a text file, placed relative to the PHP file.</p>
<p>UploadFile.php is expecting one of four things:</p>
<ol class="arabic simple">
<li>A file or files from Flash (uploadedfilesFlash)</li>
<li>A file from HTML    (uploadedfiles0)</li>
<li>Multiple files from HTML (uploadedfiles0, uploadedfiles1, etc)</li>
<li>A file array from HTML5 (uploadedfiles[])</li>
</ol>
<p>The PHP file is inspecting the header and looking for the parameters set in Uploader. Whatever you set these parameters to, they must match on the server.</p>
<p>The field name for the HTML uploader works much the same way. The only difference is if you do multi-file upload with HTML, this essentially continues to add fileInputs to the form, and in doing so, appends numbers to the fileInput field names, starting with &#8216;0&#8217;. That&#8217;s why one file fieldname will look like &#8220;myFieldName&#8221; but two files will look like [ &#8220;myFieldName0&#8221;, &#8220;myFieldName1&#8221; ] to the server side code.</p>
</div>
<div class="section" id="server-side-return-data">
<h3><a class="toc-backref" href="#id20">Server Side Return Data</a><a class="headerlink" href="#server-side-return-data" title="Permalink to this headline">¶</a></h3>
<p>How the data is returned from the server is not difficult, but it is very important. If not done correctly, it can be the cause of reported errors that the &#8220;onComplete&#8221; is not firing in Uploader.</p>
<p><strong>NOTE</strong> The Flash uploader and the HTML uploader need differently formatted return data. You will need to inspect the post data to determine which type to return.</p>
<p>If <em>uploadedfilesFlash</em> is found in the post data and Flash is being used on the client side, all that is needed for return data is a key-value string, and it can simply be returned, as at the end of a function. Flash will parse these key-value pairs into an object and pass it to javaScript. You may also want to insert <em>exit</em> or whatever necessary to cease execution of the remainder of the code. Example:</p>
<div class="highlight"><pre>$data .=&#39;file=&#39;.$file.&#39;,name=&#39;.$name.&#39;,width=&#39;.$width.&#39;,height=&#39;.$height.&#39;,type=&#39;.$type;
echo($data);
exit;
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="html"><textarea style="display:none">$data .='file='.$file.',name='.$name.',width='.$width.',height='.$height.',type='.$type;
echo($data);
exit;</textarea></div><p>For non-PHP developers this translates to:</p>
<div class="highlight-text"><div class="highlight"><pre>$name = name of the file, such as &quot;PIC01.jpg&quot;
$file = name of the file and the path, such as &quot;uploaded/PIC01.jpg&quot;
$width, $height = the dimensions (if you are working with images)
$type = the extension of the file - JPG, GIF, PNG, etc.
</pre></div>
</div>
<p>The return to Flash should look like:</p>
<div class="highlight-text"><div class="highlight"><pre>&quot;file=uploaded/PIC01.jpg,name=PIC01.jpg,width=320,height=240,type=jpg&quot;
</pre></div>
</div>
<p>This string should be returned, or printed, or echoed.</p>
<p>You can add an error key if one file was in error; say if it was not of the correct type. This error code or message will be returned in the onComplete dataArray. It's important to note that as far as the Uploader is concerned, everything was a success. It's up to your custom code to test for this error.</p>
<p>The return string with an error might look like:</p>
<div class="highlight-text"><div class="highlight"><pre>&quot;file=uploaded/PIC01.jpg,name=PIC01.jpg,width=320,height=240,type=jpg,error=Not recognized file type&quot;
</pre></div>
</div>
<p>You can also send back arbitrary parameters from your server-side script using this comma-delimited format.  For example, adding variables foo and abc:</p>
<div class="highlight-text"><div class="highlight"><pre>&quot;file=uploaded/PIC01.jpg,name=PIC01.jpg,width=320,height=240,type=jpg,foo=bar,abc=123&quot;
</pre></div>
</div>
<p>Then you can access these variables in the client-side functions using dataArray[i].additionalParams.foo and dataArray[i].additionalParams.abc.</p>
<p>If IFrame plugin is used, the code on the client side gets tricky, as reading back from an iframe presents problems. In order to read the iframe return data accurately cross browser, the code needs to be wrapped in a <em>&lt;textarea&gt;</em>. You can see the code for this on the very last line of UploadFiles.php. Note that the textarea needs to be outside of the PHP. Example:</p>
<div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="cp">    ....code....</span>
<span class="cp">?&gt;</span>
<span class="nt">&lt;textarea&gt;</span><span class="cp">&lt;?php print $json-&gt;encode($dataObject); ?&gt;</span><span class="nt">&lt;/textarea&gt;</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="html"><textarea style="display:none">&lt;?php
    ....code....
?&gt;
&lt;textarea&gt;&lt;?php print $json-&gt;encode($dataObject); ?&gt;&lt;/textarea&gt;</textarea></div><p>For non-PHP devs, this translates into a JSON string, wrapped in a textarea, returned as HTML. I know it's screwy, but that's how it works.</p>
<p>If you are having problems getting <em>onComplete</em> to fire, look at this code first. Often the problem is the server side code is not catching the field name for whatever reason (perhaps the client and server names don't match) and the code is falling to the end of the page and returning a textarea when it shouldn't.</p>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id21">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>This example shows how to use Flash and IFrame plugins for both cases (browsers with and without flash).</p>
<div class="highlight"><pre><span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.form.Uploader&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.embed.Flash&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nx">dojox</span><span class="p">.</span><span class="nx">embed</span><span class="p">.</span><span class="nx">Flash</span><span class="p">.</span><span class="nx">available</span><span class="p">){</span>
  <span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.form.uploader.plugins.Flash&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
  <span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.form.uploader.plugins.IFrame&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">u</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">Uploader</span><span class="p">({</span>
    <span class="nx">label</span><span class="o">:</span> <span class="s2">&quot;Select files&quot;</span><span class="p">,</span>
    <span class="nx">multiple</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">uploadOnSelect</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;UploadFile.php&quot;</span><span class="p">,</span>
  <span class="p">},</span> <span class="s2">&quot;uploader&quot;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="javascript"><textarea style="display:none">dojo.require(&quot;dojox.form.Uploader&quot;);
dojo.require(&quot;dojox.embed.Flash&quot;);
if(dojox.embed.Flash.available){
  dojo.require(&quot;dojox.form.uploader.plugins.Flash&quot;);
}else{
  dojo.require(&quot;dojox.form.uploader.plugins.IFrame&quot;);
}
dojo.ready(function(){
  var u = new dojox.form.Uploader({
    label: &quot;Select files&quot;,
    multiple: true,
    uploadOnSelect: true,
    url: &quot;UploadFile.php&quot;,
  }, &quot;uploader&quot;);
});</textarea></div><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;uploader&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="html"><textarea style="display:none">&lt;div id=&quot;uploader&quot;&gt;&lt;/div&gt;</textarea></div></div>
</div>


                        </div>
                    </div>
                    <div class="sidebar unit size1of4 lastUnit">
                        <h4>Reference Guide</h4>
						<div id="dtkVersion">
							<label for="refver">Dojo Version</label>
							<select id="refver" name="refver">
								<option value="1.6">1.6</option>
								<option value="1.7">1.7</option>
								<option value="1.8" selected="selected">1.8</option>
                                <option value="1.9">1.9</option>
							</select>
						</div>
                        <ul>
                            <li><a href="../../index.html">Startpage</a></li>
                            <li><a href="../../dojo/index.html">Dojo</a></li>
                            <li><a href="../../dijit/index.html">Dijit</a></li>
                            <li><a href="../index.html">DojoX</a></li>
                        </ul>
                        
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">dojox.form.Uploader</a><ul>
<li><a class="reference internal" href="#features">Features</a><ul>
<li><a class="reference internal" href="#important-amd-note">Important AMD Note</a></li>
<li><a class="reference internal" href="#important-form-note">Important Form Note</a></li>
<li><a class="reference internal" href="#missing-features">Missing Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#uploader-without-plugins">Uploader without Plugins</a></li>
<li><a class="reference internal" href="#uploader-with-the-html5-plugin">Uploader with the HTML5 Plugin</a></li>
<li><a class="reference internal" href="#uploader-with-the-iframe-plugin">Uploader with the IFrame Plugin</a></li>
<li><a class="reference internal" href="#uploader-with-the-flash-plugin">Uploader with the Flash Plugin</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setup">Setup</a><ul>
<li><a class="reference internal" href="#markup">Markup</a></li>
<li><a class="reference internal" href="#programmatic">Programmatic</a></li>
<li><a class="reference internal" href="#the-name-property">The &#8220;name&#8221; Property</a></li>
<li><a class="reference internal" href="#other-properties">Other Properties</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#server-side">Server Side</a><ul>
<li><a class="reference internal" href="#server-side-code-php">Server Side Code PHP</a></li>
<li><a class="reference internal" href="#server-side-return-data">Server Side Return Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="TimeSpinner.html"
                        title="previous chapter">dojox.form.TimeSpinner</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ValidationTextarea.html"
                        title="next chapter">dojox.form.ValidationTextarea</a></p>
    <div id="searchbox" style="display: none">
        <h3>Quick search</h3>
        <form class="search" action="../../search.html" method="get">
            <input type="text" name="q" size="18" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
         </form>
         <p class="searchtip" style="font-size: 90%">
             Enter search terms or a module, class or function name.
         </p>
    </div>
        </div>
      </div>
                    </div>
                </div>
            </div>
        </div>
        <hr class="hide" />
        <div id="foot">
            <div class="innerBox">
                <script type="text/javascript">document.write('<a href="https://docs.google.com/spreadsheet/viewform?hl=en_US&amp;formkey=dFlDcHEyaHMwbEd4MFBObkNrX0E1MFE6MQ&amp;entry_0=' + encodeURIComponent(window.location.href) + '">Error in the documentation? Can’t find what you are looking for? Let us know!</a>');</script>
                <div class="footer">
                      &copy; Copyright 2005-2012, Dojo Foundation.
                      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
                </div>
            </div>  
        </div>
        <script src="http://www.google.com/jsapi?key=ABQIAAAAbTW5DVaTIHKHQe5Q75sB0BSaOaO_TgJ5c3mtQFnk5JO2zD5dZBSGHlRJ8HAPlCQCEO_FxSmyNAHSLw" type="text/javascript"></script>
    </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>