

<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>dojo/dnd &mdash; The Dojo Toolkit - Reference Guide</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="The Dojo Toolkit - Reference Guide" href="../index.html" />
    <link rel="up" title="Dojo" href="contents.html" />
    <link rel="next" title="dojo/dnd/Moveable" href="dnd/Moveable.html" />
    <link rel="prev" title="dojo.disconnect" href="disconnect.html" />

    <link rel="stylesheet" href="../_static/css/site.css">
    <link rel="stylesheet" href="../_static/js/docs/resources/guide.css">
	<script type="text/javascript">
		dojoConfig = {
			async: true
		};
	</script>
    <script type="text/javascript" src="../_static/js/dojo/dojo.js"></script>
    <script type="text/javascript" src="../_static/js/docs/guide.js"></script>

  </head>
  <body>  

    <div class="document">
    <div id="accessibilityNode">
        <a href="#intro">Skip to Content</a> | <a href="#nav">Skip to Navigation</a>
    </div>
    <hr class="hide">
    <div id="page" class="docPage">
        <div id="header">
            <div class="container">
                <span id="logo"><a title="Home" href="http://dojotoolkit.org">
                    <img alt="Dojo Toolkit" src="../_static/images/logo.png"></a>
                </span>
                <ul id="navigation">
                    <li class="home"><a href="/"><span class="homeIcon"></span></a></li>
                    <li class="download"><a href="/download/">Download</a></li>
                    <li class="features"><a href="/features/">Features</a></li>
                    <li class="docs active"><a href="/documentation/">Documentation</a></li>
                    <li class="community"><a href="/community/">Community</a></li>
                    <li class="about"><a href="/blog/">Blog</a></li>
                </ul>
            </div>
        </div>
    
        <hr class="hide" />
    
        <div id="main">
            <div id="content" class="innerBox">
                <div class="pageTitleContainer">
                    <h1>Documentation</h1>
                    <ul class="subnav">
                        <li><a href="/documentation/"><span>Tutorials</span></a></li>
                        <li class="active"><a href="/reference-guide/"><span>Reference Guide</span></a></li>
                        <li><a href="/api/"><span>API Documentation</span></a></li>
                    </ul>
                </div>
                <div class="line">
                    <div class="unit size3of4 firstUnit">
                        <div class="spacer">
                            
  <div class="section" id="dojo-dnd">
<span id="id1"></span><h1><a class="toc-backref" href="#id25">dojo/dnd</a><a class="headerlink" href="#dojo-dnd" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">since:</th><td class="field-body">0.9</td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">Eugene Lazutkin</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#dojo-dnd" id="id25">dojo/dnd</a><ul>
<li><a class="reference internal" href="#introduction" id="id26">Introduction</a></li>
<li><a class="reference internal" href="#dojo-dnd-principals" id="id27">dojo/dnd Principals</a></li>
<li><a class="reference internal" href="#dojo-dnd-move-principals" id="id28">dojo/dnd/move Principals</a></li>
<li><a class="reference internal" href="#subclassing-dnd-classes" id="id29">Subclassing DnD classes</a></li>
<li><a class="reference internal" href="#summary-of-css-classes" id="id30">Summary of CSS classes</a></li>
<li><a class="reference internal" href="#summary-of-topics" id="id31">Summary of <tt class="docutils literal"><span class="pre">topics</span></tt></a></li>
<li><a class="reference internal" href="#tips" id="id32">Tips</a></li>
<li><a class="reference internal" href="#accessibility" id="id33">Accessibility</a></li>
<li><a class="reference internal" href="#see-also" id="id34">See also</a></li>
</ul>
</li>
</ul>
</div>
<p>The drag and drop (DnD) package/system of Dojo.</p>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id26">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><strong>dojo/dnd</strong> provides the basic user interface concepts of &#8220;drag and drop&#8221; where a user interface element it clicked,
dragged and then dropped in another location. <tt class="docutils literal"><span class="pre">dojo/dnd</span></tt> uses an &#8220;avatar&#8221; to represent objects that are being dragged
from one location to another. As the avatar is shifted, it is designed to not obscure objects under the mouse giving
better visibility. Additionally, it is possible to represent objects in the <a class="reference internal" href="#avatar">Avatar</a> differently, which is described in
detail below. A special sub-package <tt class="docutils literal"><span class="pre">dojo/dnd/move</span></tt> accommodates direct movement of elements in the <em>old style</em> of
Dojo Drag and Drop (version 0.4).</p>
<p>DnD (both <a class="reference internal" href="#dojo-dnd"><em>dojo.dnd</em></a> and <em class="xref std std-ref">dojo.dnd.move</em> packages) is implemented as a state
machine, which reflects its state by adding and removing CSS classes to relevant objects, which gives the ultimate
flexibility over customizing the look-and-feel.</p>
<p>Every DnD container and DnD item has the concept of a type. The type is represented by a unique text string. Every
container and item has an array of types assigned to them. In order to transfer (drop) items on a container they should
have at least one type in common. When transferring a group of items to a container all items should have at least one
type in common with the container. Otherwise the transfer is denied. If the list of types is not specified <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt>
is assumed.</p>
<p><tt class="docutils literal"><span class="pre">dojo/dnd</span></tt> supports copy and move styles with DnD out of the box.</p>
<div class="section" id="user-interface">
<h3>User interface<a class="headerlink" href="#user-interface" title="Permalink to this headline">¶</a></h3>
<p>The existing implementation supports a <em>linear</em> container paradigm:</p>
<ul class="simple">
<li>Selection of an item on a mouse <em>click</em>.</li>
<li>Adding an item to the existing selection by <em>ctrl+click</em>.</li>
<li>Selecting a range of items by <em>shift+click</em>.</li>
<li>Adding a range of items by <em>ctrl+shift+click</em>.</li>
</ul>
<p><em>Note</em> On a Macintosh the Meta key is used instead of the Ctrl key.</p>
<p><em>Note</em> In order to show an insertion point correctly, it is possible to specify if we are dealing with a vertical or
horizontal container.</p>
<p>See <a class="reference internal" href="#selector">Selector</a> for more details.</p>
</div>
</div>
<div class="section" id="dojo-dnd-principals">
<h2><a class="toc-backref" href="#id27">dojo/dnd Principals</a><a class="headerlink" href="#dojo-dnd-principals" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">dojo/dnd</span></tt> consists of 5 classes: <a class="reference internal" href="#container">Container</a>, <a class="reference internal" href="#selector">Selector</a>, <a class="reference internal" href="#source">Source</a>, <a class="reference internal" href="#manager">Manager</a>, and <a class="reference internal" href="#avatar">Avatar</a>. The first three classes
are responsible for DnD sources and targets. The last two classes are singletons responsible for orchestration of DnD on
the web page.</p>
<div class="section" id="container">
<h3>Container<a class="headerlink" href="#container" title="Permalink to this headline">¶</a></h3>
<p>The default implementation of <tt class="docutils literal"><span class="pre">dojo/dnd/Container</span></tt> represents a uniform linear collection of items. It knows when the mouse hovers over it, and when the mouse hovers over a particular item.</p>
<p>The draggable item is represented by an abstract data object, which can be anything. There is a function <tt class="docutils literal"><span class="pre">creator</span></tt>, which is called when we need to visualize a data item for the <a class="reference internal" href="#container">container</a>, or for the <a class="reference internal" href="#avatar">avatar</a>. It allows us to have different representations of the same data item in different containers and in the <a class="reference internal" href="#avatar">avatar</a>. More on that later.</p>
<div class="section" id="constructor">
<h4>Constructor<a class="headerlink" href="#constructor" title="Permalink to this headline">¶</a></h4>
<p>Constructor take two parameters:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">node</span></tt></dt>
<dd>A DOM node or the String ID of a node. This node represents a container. All draggable items will be direct
descendants of this node (the important exception: a <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt> node, in this case items will be direct descendants
of the embedded <tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt> node). If you want to override this default behavior, use <tt class="docutils literal"><span class="pre">dropParent</span></tt> attribute of
<tt class="docutils literal"><span class="pre">params</span></tt> (see below).</dd>
<dt><tt class="docutils literal"><span class="pre">params</span></tt></dt>
<dd><p class="first">a dictionary object, which defines optional parameters. Following optional parameters are recognized:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">creator(item,</span> <span class="pre">hint)</span></tt></dt>
<dd>A creator function, which is used to build a representation of the data item.</dd>
<dt><tt class="docutils literal"><span class="pre">item</span></tt></dt>
<dd>a data item (an abstract object), which defines a draggable object. The creator function is solely responsible for
the interpretation of this item.</dd>
<dt><tt class="docutils literal"><span class="pre">hint</span></tt></dt>
<dd>An optional string, which hints at the purpose of the call. The creator function can use it to produce different
visual representations. At the moment only one value is defined: <tt class="docutils literal"><span class="pre">&quot;avatar&quot;</span></tt>. When <tt class="docutils literal"><span class="pre">hint</span> <span class="pre">==</span> <span class="pre">&quot;avatar&quot;</span></tt> the creator
can produce a special version for the avatar.</dd>
<dt><tt class="docutils literal"><span class="pre">type</span></tt></dt>
<dd>An array of strings, which identify the type of this item. It is used during the DnD operation to select compatible
targets.</dd>
<dt><tt class="docutils literal"><span class="pre">skipForm</span></tt></dt>
<dd>If it is <tt class="docutils literal"><span class="pre">true</span></tt>, the container passes selection and dragging operations to the browser, otherwise it suppresses
them. It is useful when draggable items include text form elements that can be edited. By default it is <tt class="docutils literal"><span class="pre">false</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">dropParent</span></tt></dt>
<dd>a DOM node below the main node, which serves as a physical container for data item nodes. It can be used to
structure the visual design of your container. This value will be assigned to <tt class="docutils literal"><span class="pre">parent</span></tt> attribute of the container
(see below).</dd>
</dl>
</dd>
</dl>
<p>During the construction the constructor checks immediate children of <tt class="docutils literal"><span class="pre">parent</span></tt> attribute (see below) for the presence
of <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class. All such items are added as container&#8217;s children automatically. It is assumed that you already
built the visual representation of the data item, so the creator function is not involved. Instead the necessary triplet
is formed like this:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">node</span></tt></dt>
<dd>the node itself. If it doesn&#8217;t have an id, a unique id is generated for it.</dd>
<dt><tt class="docutils literal"><span class="pre">data</span></tt></dt>
<dd>the content of <tt class="docutils literal"><span class="pre">dndData</span></tt> member of the node. If it is missing, <tt class="docutils literal"><span class="pre">node.innerHTML</span></tt> is used instead.</dd>
<dt><tt class="docutils literal"><span class="pre">type</span></tt></dt>
<dd>the content of <tt class="docutils literal"><span class="pre">dndType</span></tt> member of the node split on &#8221;,&#8221; character. If it is missing, <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt> is used as the
default type.</dd>
</dl>
</div>
<div class="section" id="default-creator">
<h4>Default creator<a class="headerlink" href="#default-creator" title="Permalink to this headline">¶</a></h4>
<p>If the creator function was not specified, a default creator is used. The default creator does following things:</p>
<ul class="simple">
<li>It creates a context-appropriate node:<ul>
<li>If the container is <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt> or <tt class="docutils literal"><span class="pre">&lt;p&gt;</span></tt>-based, it will create a <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt> node.</li>
<li>If the container is <tt class="docutils literal"><span class="pre">&lt;ul&gt;</span></tt> or <tt class="docutils literal"><span class="pre">&lt;ol&gt;</span></tt>-based, it will create a <tt class="docutils literal"><span class="pre">&lt;li&gt;</span></tt> node.</li>
<li>If the container is <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt>-based, it will create a <tt class="docutils literal"><span class="pre">&lt;tr&gt;&lt;td&gt;</span></tt> group of nodes, and it will be inserted in
<tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt>.</li>
<li>In all other contexts it will create a <tt class="docutils literal"><span class="pre">&lt;span&gt;</span></tt> node.</li>
<li>If the <tt class="docutils literal"><span class="pre">hint</span></tt> is <tt class="docutils literal"><span class="pre">&quot;avatar&quot;</span></tt> it will create a <tt class="docutils literal"><span class="pre">&lt;span&gt;</span></tt> node.</li>
</ul>
</li>
<li>If the data item is an object, it will test for the presence of <tt class="docutils literal"><span class="pre">data</span></tt> member. If it is present, it will be used as
a data object. Otherwise the item itself will be used as a data object.</li>
<li>If the data item is an object, it will test for the presence of <tt class="docutils literal"><span class="pre">type</span></tt> member. If it is present, it will be used as
a type object. Otherwise <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt> will be used as a type object.</li>
<li>It will set a content of the node to <tt class="docutils literal"><span class="pre">String(data)</span></tt>. You can override the <tt class="docutils literal"><span class="pre">toString()</span></tt> member function of your
object to change how it is converted to the string. Or specify the <tt class="docutils literal"><span class="pre">creator</span></tt> function.</li>
<li>As any creator it returns a triplet object with newly created/identified <tt class="docutils literal"><span class="pre">node</span></tt>, <tt class="docutils literal"><span class="pre">data</span></tt>, and <tt class="docutils literal"><span class="pre">type</span></tt>.</li>
</ul>
<p>After the creator function was called the result is post-processed:</p>
<ul class="simple">
<li>If the returned node doesn&#8217;t have an <tt class="docutils literal"><span class="pre">id</span></tt>, the default unique id will be generated.</li>
<li>The returned node will be assigned a <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</li>
<li>If the returned <tt class="docutils literal"><span class="pre">type</span></tt> is not an array or missing, it will be replaced with <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt>.</li>
</ul>
</div>
<div class="section" id="public-methods-and-attributes">
<h4>Public methods and attributes<a class="headerlink" href="#public-methods-and-attributes" title="Permalink to this headline">¶</a></h4>
<p>The following public methods are defined:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">getAllNodes()</span></tt></dt>
<dd>returns a <tt class="docutils literal"><span class="pre">NodeList</span></tt> of all controlled DOM nodes in the order they are listed in the container.</dd>
<dt><tt class="docutils literal"><span class="pre">insertNodes(data,</span> <span class="pre">before,</span> <span class="pre">anchor)</span></tt></dt>
<dd><p class="first">inserts data items before/after the anchor node. It returns the container object itself for easy chaining of calls.</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">data</span></tt></dt>
<dd>an array of data items to be inserted. Each data item will be passed to the creator function, the result will
be registered with the container, the node will be inserted according to <tt class="docutils literal"><span class="pre">before</span></tt> and <tt class="docutils literal"><span class="pre">anchor</span></tt> parameters.</dd>
<dt><tt class="docutils literal"><span class="pre">before</span></tt></dt>
<dd>a boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, nodes will be added before the <tt class="docutils literal"><span class="pre">anchor</span></tt>, and after otherwise.</dd>
<dt><tt class="docutils literal"><span class="pre">anchor</span></tt></dt>
<dd>a node to be used as a reference for the insertion. It should be an immediate child of the container node (or a
child of <tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt> for the <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt>-based node). If it is not specified, all items will be appended to the
container node (or <tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt> for tables).</dd>
</dl>
</dd>
<dt><tt class="docutils literal"><span class="pre">destroy()</span></tt></dt>
<dd>prepares the container object to be garbage-collected. You cannot use the container object after it was destroyed.</dd>
<dt><tt class="docutils literal"><span class="pre">sync()</span></tt></dt>
<dd>inspects all controlled DOM nodes updating internal structures by removing information of removed nodes, and adding
newly added DOM nodes marked with <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</dd>
</dl>
<p>The following public attributes are defined:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">current</span></tt></dt>
<dd>a DOM node, which corresponds to a child with a mouse hovering over it. If there is no such item, this variable is
null.</dd>
<dt><tt class="docutils literal"><span class="pre">node</span></tt></dt>
<dd>the DOM node of the container. This node is used to set up mouse event handlers for the container.</dd>
<dt><tt class="docutils literal"><span class="pre">parent</span></tt></dt>
<dd>the DOM node, which is an immediate parent of DnD item nodes. In most cases it is the same as node, but in some cases
it can be node&#8217;s descendant. Example: for tables <tt class="docutils literal"><span class="pre">node</span></tt> can point to <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt>, while <tt class="docutils literal"><span class="pre">parent</span></tt> points to
<tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt> (DnD item nodes will be <tt class="docutils literal"><span class="pre">&lt;tr&gt;</span></tt> nodes). You can freely change parent to achieve the desired behavior of
your container by specifying <tt class="docutils literal"><span class="pre">dropParent</span></tt> parameter.</dd>
<dt><tt class="docutils literal"><span class="pre">creator</span></tt></dt>
<dd>the creator function or <tt class="docutils literal"><span class="pre">null</span></tt>, if the default creator is used.</dd>
<dt><tt class="docutils literal"><span class="pre">skipForm</span></tt></dt>
<dd>the flag propagated from the initial parameters.</dd>
<dt><tt class="docutils literal"><span class="pre">map</span></tt></dt>
<dd><p class="first">a dictionary, which is keyed by node ids. Each registered child has an entry in the <tt class="docutils literal"><span class="pre">map</span></tt> by its node id (this is
why all nodes should have unique ids). <tt class="docutils literal"><span class="pre">map[id]</span></tt> returns an object with two attributes:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">data</span></tt></dt>
<dd>an associated data item.</dd>
<dt><tt class="docutils literal"><span class="pre">type</span></tt></dt>
<dd>an associated array of types.</dd>
</dl>
<p><em>Note</em> that <tt class="docutils literal"><span class="pre">map</span></tt> does not contain a reference to any DOM nodes; its purpose is to store metadata, <tt class="docutils literal"><span class="pre">data</span></tt> and
<tt class="docutils literal"><span class="pre">type</span></tt>, associated with the DOM node. For example, if you wish to programmatically move a DnD item from one
<tt class="docutils literal"><span class="pre">Source</span></tt> to another, you must perform DOM manipulations in addition to moving the item from one <tt class="docutils literal"><span class="pre">Source</span></tt>&#8216;s <tt class="docutils literal"><span class="pre">map</span></tt>
to the other <tt class="docutils literal"><span class="pre">Source</span></tt>&#8216;s <tt class="docutils literal"><span class="pre">map</span></tt>.</p>
<p class="last">However, it is not recommended to access <tt class="docutils literal"><span class="pre">map</span></tt> directly. There are several utility functions to access it. They can
be used to virtualize the map, and you can use them with <tt class="docutils literal"><span class="pre">dojo.connect()</span></tt> so you know when DnD items are
added/removed/accessed and use it to customize the behavior:</p>
</dd>
</dl>
<p>The following accessor and utility functions are defined:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">getItem(id)</span></tt></dt>
<dd>returns an object with <tt class="docutils literal"><span class="pre">data</span></tt> and <tt class="docutils literal"><span class="pre">type</span></tt> described above, which are associated with the node corresponding to that
<tt class="docutils literal"><span class="pre">id</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">setItem(id,</span> <span class="pre">obj)</span></tt></dt>
<dd>associates an object <tt class="docutils literal"><span class="pre">obj</span></tt> with this <tt class="docutils literal"><span class="pre">id</span></tt>. <tt class="docutils literal"><span class="pre">obj</span></tt> should define <tt class="docutils literal"><span class="pre">data</span></tt> and <tt class="docutils literal"><span class="pre">type</span></tt> attributes.</dd>
<dt><tt class="docutils literal"><span class="pre">delItem(id)</span></tt></dt>
<dd>deletes a record of the node with this <tt class="docutils literal"><span class="pre">id</span></tt>. <strong>Warning:</strong> it does not delete the node from the container.</dd>
<dt><tt class="docutils literal"><span class="pre">clearItems()</span></tt></dt>
<dd>delete all records. <strong>Warning:</strong> it does not delete nodes from the container.</dd>
<dt><tt class="docutils literal"><span class="pre">forInItems(f,</span> <span class="pre">o)</span></tt></dt>
<dd><p class="first">similar to <tt class="docutils literal"><span class="pre">dojo.forEach()</span></tt> but goes over all items in the map in an unspecified order. The function <tt class="docutils literal"><span class="pre">f</span></tt> will be
called in the context <tt class="docutils literal"><span class="pre">o</span></tt> for every item in the <tt class="docutils literal"><span class="pre">map</span></tt> with following parameters:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">obj</span></tt></dt>
<dd>the corresponding object with <tt class="docutils literal"><span class="pre">data</span></tt> and <tt class="docutils literal"><span class="pre">type</span></tt> defined.</dd>
<dt><tt class="docutils literal"><span class="pre">id</span></tt></dt>
<dd>the node id.</dd>
<dt><tt class="docutils literal"><span class="pre">map</span></tt></dt>
<dd>the map object itself.</dd>
</dl>
<p><em>Note:</em> <tt class="docutils literal"><span class="pre">forInItems()</span></tt> iterates over all DnD items in unspecified order. If you want to iterate over items in the
order they are listed in the container you can use the code similar to this:</p>
<div class="highlight"><pre><span class="kd">function</span> <span class="nx">OrderedIter</span><span class="p">(</span><span class="nx">container</span><span class="p">,</span> <span class="nx">f</span><span class="p">,</span> <span class="nx">o</span><span class="p">){</span>
  <span class="c1">// similar to:</span>
  <span class="c1">// container.forInItems(f, o);</span>
  <span class="c1">// but iterates in the listed order</span>

  <span class="nx">o</span> <span class="o">=</span> <span class="nx">o</span> <span class="o">||</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">global</span><span class="p">;</span>
  <span class="nx">container</span><span class="p">.</span><span class="nx">getAllNodes</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="nx">f</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">container</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">container</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="javascript"><textarea style="display:none">function OrderedIter(container, f, o){
  // similar to:
  // container.forInItems(f, o);
  // but iterates in the listed order

  o = o || dojo.global;
  container.getAllNodes().forEach(function(node){
    var id = node.id;
    f.call(o, container.getItem(id), id, container);
  });
}</textarea></div></dd>
</dl>
</div>
<div class="section" id="event-processors">
<h4>Event processors<a class="headerlink" href="#event-processors" title="Permalink to this headline">¶</a></h4>
<p>Following event processors are defined: <tt class="docutils literal"><span class="pre">onMouseOver</span></tt>, <tt class="docutils literal"><span class="pre">onMouseOut</span></tt>. Two pseudo-events are defined: <tt class="docutils literal"><span class="pre">onOverEvent</span></tt>,
<tt class="docutils literal"><span class="pre">onOutEvent</span></tt>, which are cleaned up argument-less <tt class="docutils literal"><span class="pre">onMouseOver</span></tt> and <tt class="docutils literal"><span class="pre">onMouseOut</span></tt> events (otherwise they can be
fired several times without actually leaving the container).</p>
</div>
<div class="section" id="css-classes">
<h4>CSS classes<a class="headerlink" href="#css-classes" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by the container object:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndContainer</span></tt></dt>
<dd>assigned to each container node during the construction.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndContainerOver</span></tt></dt>
<dd>assigned when the mouse hovers over the container.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItem</span></tt></dt>
<dd>assigned to every new data item node. It should be assigned to every item before the container construction, if you
want it to be added automatically by the constructor.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemOver</span></tt></dt>
<dd>assigned to a data item node when the mouse hovers over the this item. This class is assigned in addition to
<tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</dd>
</dl>
<p>Partial reason to add &#8220;over&#8221; states when the mouse hovers over instead of using CSS was to support it in Internet
Explorer too.</p>
</div>
</div>
<div class="section" id="selector">
<h3>Selector<a class="headerlink" href="#selector" title="Permalink to this headline">¶</a></h3>
<p>The default implementation of <tt class="docutils literal"><span class="pre">Selector</span></tt> is built on top of <a class="reference internal" href="#container">Container</a> and adds the ability to select children items.
Selector inherits all <a class="reference internal" href="#container">Container</a>&#8216;s methods and objects. Additionally it adds a notion of an anchor. The anchor is used
to specify a point of insertion of other items. The selector assumes that the container is organized in a linear fashion
either vertically (e.g., embedded <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt>s, lists, tables) or horizontally (e.g., <tt class="docutils literal"><span class="pre">&lt;span&gt;</span></tt>s). This assumption
allows implementation of familiar user interface paradigms: selection of one element with a mouse <em>click</em>, selection of
an additional element with <em>ctrl+click</em>, linear group selection from the anchor to the clicked element with
<em>shift+click</em>, selecting an additional linear group from the anchor to the clicked element with <em>shift+ctrl+click</em>.
Obviously if you have more complex containers, you could implement different user interface actions.</p>
<div class="section" id="id2">
<h4>Constructor<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Constructor takes the same two parameters as the <a class="reference internal" href="#container">Container</a>&#8216;s constructor. It understands more optional parameters and
passes the rest to the underlying container. Following optional parameters are understood by the selector object:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">singular</span></tt></dt>
<dd>a Boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, the user is allowed to select just one item, otherwise any number of items can be
selected. It is <tt class="docutils literal"><span class="pre">false</span></tt> by default.</dd>
<dt><tt class="docutils literal"><span class="pre">autoSync</span></tt></dt>
<dd>a Boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, Selector calls <a class="reference internal" href="#container">Container</a>&#8216;s <tt class="docutils literal"><span class="pre">sync()</span></tt> method for every <tt class="docutils literal"><span class="pre">onMouseDown</span></tt>. It helps
when you add/remove DnD items using HTML DOM API, but can be taxing for containers with large number of DnD items. In
order to be more efficient consider calling <tt class="docutils literal"><span class="pre">sync()</span></tt> method after the manipulations were done, or (even more
efficient) adding new DnD items using <tt class="docutils literal"><span class="pre">insertNodes()</span></tt> method. The default value of this parameter is <tt class="docutils literal"><span class="pre">false</span></tt>.</dd>
</dl>
</div>
<div class="section" id="id3">
<h4>Public methods and attributes<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Following public methods are defined in addition to the container public methods:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">getSelectedNodes()</span></tt></dt>
<dd>returns a <a class="reference internal" href="NodeList.html#dojo-nodelist"><em>NodeList</em></a> of selected DOM nodes.</dd>
<dt><tt class="docutils literal"><span class="pre">selectNone()</span></tt></dt>
<dd>remove the selection from all items. It returns the selector object itself for easy chaining of calls.</dd>
<dt><tt class="docutils literal"><span class="pre">selectAll()</span></tt></dt>
<dd>selects all items. It returns the selector object itself for easy chaining of calls.</dd>
<dt><tt class="docutils literal"><span class="pre">deleteSelectedNodes()</span></tt></dt>
<dd>deletes all selected nodes. It returns the selector object itself for easy chaining of calls.</dd>
</dl>
<p>Following public method is redefined with a new signature:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">insertNodes(addSelected,</span> <span class="pre">data,</span> <span class="pre">before,</span> <span class="pre">anchor)</span></tt></dt>
<dd>the last three parameters are the same as in <a class="reference internal" href="#container">Container</a>. The first parameter is a flag, if it is <tt class="docutils literal"><span class="pre">true</span></tt> all newly
added items will be added as selected, otherwise they will be added unselected.</dd>
</dl>
<p>The container object defines following public attributes:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">selection</span></tt></dt>
<dd>a dictionary object keyed by ids of selected nodes. No useful payload is attached to objects in the dictionary.</dd>
<dt><tt class="docutils literal"><span class="pre">anchor</span></tt></dt>
<dd>the current anchor node or <tt class="docutils literal"><span class="pre">null</span></tt>.</dd>
</dl>
</div>
<div class="section" id="id4">
<h4>Event processors<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Following event processors are defined: <tt class="docutils literal"><span class="pre">onMouseDown</span></tt>, <tt class="docutils literal"><span class="pre">onMouseUp</span></tt>. <tt class="docutils literal"><span class="pre">onMouseMove</span></tt> is attached by <tt class="docutils literal"><span class="pre">onOverEvent</span></tt> and detached by <tt class="docutils literal"><span class="pre">onOutEvent</span></tt> dynamically.</p>
</div>
<div class="section" id="id5">
<h4>CSS classes<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by the selector object in addition to classes assigned the container object:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndItemSelected</span></tt></dt>
<dd>assigned if a data item is selected but it is not an anchor (the last selected element). This class is assigned in
addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemAnchor</span></tt></dt>
<dd>assigned to an anchor data item. At any given time the selector can have zero or one anchor. This class is assigned in
addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class. Being an anchor means that this item is selected.</dd>
</dl>
</div>
</div>
<div class="section" id="source">
<h3>Source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h3>
<p>The source object represents a source of items for DnD operations. It is used to represent DnD targets as well. In order
to be compatible your custom sources should emulate the common source API. Instances of this class can be created from
the HTML markup automatically by <a class="reference internal" href="parser.html#dojo-parser"><em>dojo/parser</em></a> using <tt class="docutils literal"><span class="pre">data-dojo-type=&quot;dojo/dnd/Source&quot;</span></tt>.</p>
<p>The default implementation of the source is built on top of <a class="reference internal" href="#selector">Selector</a>, and adds the ability to start a DnD operation,
and participate in the orchestration of the DnD. <a class="reference internal" href="#source">Source</a> inherits all <a class="reference internal" href="#selector">Selector</a>&#8216;s (and <a class="reference internal" href="#container">Container</a>&#8216;s) methods and
attributes. User can initiate the DnD operation by dragging items (click and move without releasing the mouse). The DnD
operation can be used to rearrange items within a single source, or items can be moved or copied between two sources.
The user can select whether they want to copy or move items by pressing the <cite>Ctrl</cite> button during the operation. If
<cite>Ctrl</cite> is pressed, items will be copied, otherwise they will be moved. This behavior can be overwritten
programmatically.</p>
<div class="section" id="id6">
<h4>Constructor<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Constructor takes the same two parameters as the container&#8217;s <a class="reference internal" href="#selector">Selector</a>. It understands more optional parameters and
passes the rest to the underlying <a class="reference internal" href="#selector">Selector</a>. Following optional parameters are understood by the source object:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">isSource</span></tt></dt>
<dd>a Boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, this object can be used to start the DnD operation, otherwise it can serve only as
a target. It is <tt class="docutils literal"><span class="pre">true</span></tt> by default.</dd>
<dt><tt class="docutils literal"><span class="pre">accept</span></tt></dt>
<dd>an array of strings. It defines what types can be accepted by this object, when it is used as a target. The default is
<tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt>. If the array is empty it means that this source cannot be a target.</dd>
<dt><tt class="docutils literal"><span class="pre">horizontal</span></tt></dt>
<dd>a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the source is based on the horizontally organized list container, otherwise it is based
on the vertical one. The default is <tt class="docutils literal"><span class="pre">false</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">withHandles</span></tt></dt>
<dd>a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, an item can be dragged only by a predefined node inside the item, otherwise the whole
item can be used for dragging. By default it is <tt class="docutils literal"><span class="pre">false</span></tt>. The handle should be a descendant of the item node and
should be marked with class <tt class="docutils literal"><span class="pre">dojoDndHandle</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">copyOnly</span></tt></dt>
<dd>a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the source doesn&#8217;t allow to move items out of it, any DnD operation will copy items from
such sources. By default it is <tt class="docutils literal"><span class="pre">false</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">selfCopy</span></tt></dt>
<dd>a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the source copies items by default when dropping on itself. It is <tt class="docutils literal"><span class="pre">false</span></tt> by default.
This flag has meaning only if <tt class="docutils literal"><span class="pre">copyOnly</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">selfAccept</span></tt></dt>
<dd>a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the source accepts its own items. It is <tt class="docutils literal"><span class="pre">true</span></tt> by default. This flag has meaning only
if <tt class="docutils literal"><span class="pre">copyOnly</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">delay</span></tt></dt>
<dd>a number, which defines the move delay in pixels before detecting a drag; 0 (no delay) by default.</dd>
</dl>
</div>
<div class="section" id="id7">
<h4>Public methods and attributes<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>The following public methods are defined (they can be replaced to change the DnD behavior):</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">checkAcceptance(source,</span> <span class="pre">nodes)</span></tt></dt>
<dd><p class="first">returns <tt class="docutils literal"><span class="pre">true</span></tt>, if this object can accept <tt class="docutils literal"><span class="pre">nodes</span></tt> from <tt class="docutils literal"><span class="pre">source</span></tt>. The default implementation checks item&#8217;s types
with accepted types of the object, and rejects the operation if there is no full match. Such objects are marked as
disabled targets and they do not participate in the current DnD operation. The source of items can always accept its
items regardless of the match (for exceptions see the definition of <tt class="docutils literal"><span class="pre">selfAccept</span></tt> above) preventing the situation
when user started to drag items and cannot find a suitable target, and cannot return them back. Take this into
consideration when replacing the method. The <a class="reference internal" href="#target">Target</a>&#8216;s <tt class="docutils literal"><span class="pre">checkAcceptance()</span></tt> is called during the DnD in progress when
user hovers above it. Following parameters are passed to the method:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">source</span></tt></dt>
<dd>the source object for the dragged items.</dd>
<dt><tt class="docutils literal"><span class="pre">nodes</span></tt></dt>
<dd>a list of DOM nodes.</dd>
</dl>
</dd>
<dt><tt class="docutils literal"><span class="pre">copyState(keyPressed)</span></tt></dt>
<dd><p class="first">returns <tt class="docutils literal"><span class="pre">true</span></tt> if the copy operation should be performed, the move will be performed otherwise. The default
implementation checks the <tt class="docutils literal"><span class="pre">copyOnly</span></tt> and <tt class="docutils literal"><span class="pre">selfCopy</span></tt> parameters described above. This method can be replaced if you
want to implement a more complex logic. Following parameters are passed in:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">keyPressed</span></tt></dt>
<dd>a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, user pressed the <tt class="docutils literal"><span class="pre">copy</span></tt> key.</dd>
<dt><tt class="docutils literal"><span class="pre">self</span></tt></dt>
<dd>a Boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, we are about to drop items on itself.</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="id8">
<h4>Event processors<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>Following event handlers are overloaded: <tt class="docutils literal"><span class="pre">onMouseDown</span></tt>, <tt class="docutils literal"><span class="pre">onMouseUp</span></tt>, and <tt class="docutils literal"><span class="pre">onMouseMove</span></tt>. They are used to perform
additional actions required by <a class="reference internal" href="#source">Source</a>.</p>
<p>Following local events are defined by <a class="reference internal" href="#source">Source</a>, which are meant to be overridden or connected with
<a class="reference internal" href="on.html#dojo-on"><em>dojo/on</em></a> or <a class="reference internal" href="_base/connect.html#dojo-base-connect"><em>dojo.connect()</em></a>:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">onDrop(source,</span> <span class="pre">nodes,</span> <span class="pre">copy)</span></tt></dt>
<dd><p class="first">this method is called when DnD items is dropped in this target. The default implementation calls <tt class="docutils literal"><span class="pre">onDropExternal()</span></tt>
or <tt class="docutils literal"><span class="pre">onDropInternal()</span></tt> based on the value of <tt class="docutils literal"><span class="pre">source</span></tt> (see below). Following parameters are passed in:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">source</span></tt></dt>
<dd>the source of dragged items, can be the same object as the target.</dd>
<dt><tt class="docutils literal"><span class="pre">nodes</span></tt></dt>
<dd>the array of DOM nodes to be dropped. Their IDs can be used to access associated types and data.</dd>
<dt><tt class="docutils literal"><span class="pre">copy</span></tt></dt>
<dd>the Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the target is requested to copy items, otherwise the target should move items.</dd>
</dl>
</dd>
<dt><tt class="docutils literal"><span class="pre">onDropExternal(source,</span> <span class="pre">nodes,</span> <span class="pre">copy)</span></tt></dt>
<dd>this method is called by the default implementation of <tt class="docutils literal"><span class="pre">onDrop()</span></tt> only if we have an external drop meaning that the
source is different from the target. All parameters are the same as in <tt class="docutils literal"><span class="pre">onDrop()</span></tt>. The default implementation
performs the drop as instructed.</dd>
<dt><tt class="docutils literal"><span class="pre">onDropInternal(nodes,</span> <span class="pre">copy)</span></tt></dt>
<dd>this method is called by the default implementation of <tt class="docutils literal"><span class="pre">onDrop()</span></tt> only if we have an internal drop.  This means that
the source is the same as the target. All parameters are the same as in <tt class="docutils literal"><span class="pre">onDrop()</span></tt>, but <tt class="docutils literal"><span class="pre">source</span></tt> parameter is
skipped as redundant (it is the same as <tt class="docutils literal"><span class="pre">this</span></tt>). The default implementation performs the drop as instructed.</dd>
<dt><tt class="docutils literal"><span class="pre">onDraggingOver()</span></tt></dt>
<dd>this method is called during the DnD operation in progress when the mouse is over this target, and it is not disabled
for any reasons. The default implementation does nothing.</dd>
<dt><tt class="docutils literal"><span class="pre">onDraggingOut()</span></tt></dt>
<dd>this method is called during the DnD operation in progress when the mouse went out of this target, and it is not
disabled for any reasons. The default implementation does nothing.</dd>
</dl>
</div>
<div class="section" id="topic-processors">
<h4>Topic processors<a class="headerlink" href="#topic-processors" title="Permalink to this headline">¶</a></h4>
<p>Following topic listeners are defined: <tt class="docutils literal"><span class="pre">onDndSourceOver</span></tt>, <tt class="docutils literal"><span class="pre">onDndStart</span></tt>, <tt class="docutils literal"><span class="pre">onDndDrop</span></tt>, <tt class="docutils literal"><span class="pre">onDndCancel</span></tt>. These topics
are published by the <a class="reference internal" href="#manager">Manager</a>. If you want to override topic listeners, please read <a class="reference internal" href="#summary-of-topics">Summary of topics</a>.</p>
<p><strong>Warning:</strong> in most cases you want to use events. Topics are low-level constructs, which are used internally and
generally should not be used for customization.</p>
</div>
<div class="section" id="id9">
<h4>CSS classes<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by the source object in addition to classes assigned by <a class="reference internal" href="#selector">Selector</a> and <a class="reference internal" href="#container">Container</a> objects:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndHorizontal</span></tt></dt>
<dd>assigned to the container node during the construction, if this object represents a horizontal list of <tt class="docutils literal"><span class="pre">dndItems</span></tt>,
its <tt class="docutils literal"><span class="pre">horizontal</span></tt> property set to <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndSource</span></tt></dt>
<dd>assigned to the container node during the construction, if this object can be used as a source of DnD items, its
<tt class="docutils literal"><span class="pre">isSource</span></tt> property set to true.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndSourceCopied</span></tt></dt>
<dd>assigned to the container node during the active DnD operation when user copies items from it (e.g. pressed the
<em>Ctrl</em> key while dragging). When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> class is removed.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndSourceMoved</span></tt></dt>
<dd>assigned to the container node during the active DnD operation when user moves items from it (e.g. the <em>Ctrl</em> key is
not pressed while dragging). When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> class is removed.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt></dt>
<dd>assigned to the container node during the construction, if this object can potentially accept DnD items, its
<tt class="docutils literal"><span class="pre">accept</span></tt> list is not empty.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndTargetDisabled</span></tt></dt>
<dd>assigned to the container node during the active DnD operation when this node cannot accept currently dragged items
(e.g. because it doesn&#8217;t accept items of these types). When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt>
class is removed.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemBefore</span></tt></dt>
<dd>assigned to the data item node during the active DnD operation if transferred items will be inserted before this item.
This class is assigned in addition to all other classes.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemAfter</span></tt></dt>
<dd>assigned to the data item node during the active DnD operation if transferred items will be inserted after this item.
This class is assigned in addition to all other classes.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndHandle</span></tt></dt>
<dd>assigned to handles of item nodes. See <tt class="docutils literal"><span class="pre">withHandles</span></tt> parameter of <a class="reference internal" href="#source">Source</a> above.</dd>
</dl>
<p><tt class="docutils literal"><span class="pre">dojoDndSource</span></tt>, <tt class="docutils literal"><span class="pre">dojoDndSourceCopied</span></tt>, and <tt class="docutils literal"><span class="pre">dojoDndSourceMoved</span></tt> are mutually exclusive. <tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt>, and
<tt class="docutils literal"><span class="pre">dojoDndTargetDisabled</span></tt> are mutually exclusive. <tt class="docutils literal"><span class="pre">dojoDndSourceCopied</span></tt>, <tt class="docutils literal"><span class="pre">dojoDndSourceMoved</span></tt>,
<tt class="docutils literal"><span class="pre">dojoDndTargetDisabled</span></tt>, <tt class="docutils literal"><span class="pre">dojoDndItemBefore</span></tt>, and <tt class="docutils literal"><span class="pre">dojoDndItemAfter</span></tt> can be assigned only during the active DnD
operation. See the <a class="reference internal" href="#manager">Manager</a>&#8216;s classes below to see what additional classes can be used for custom styling. Use
<tt class="docutils literal"><span class="pre">dojoDndHorizontal</span></tt> with <tt class="docutils literal"><span class="pre">dojoDndItemBefore</span></tt> and <tt class="docutils literal"><span class="pre">dojoDndItemAfter</span></tt> to create visually appropriate insertion
markers for horizontal (before, after) and vertical (above, below) containers.</p>
</div>
</div>
<div class="section" id="target">
<h3>Target<a class="headerlink" href="#target" title="Permalink to this headline">¶</a></h3>
<p>Essentially it is <a class="reference internal" href="#source">Source</a> wrapped in with <tt class="docutils literal"><span class="pre">isSource</span></tt> set to <tt class="docutils literal"><span class="pre">false</span></tt>. Instances of this class can be created from the
HTML markup automatically by <a class="reference internal" href="parser.html#dojo-parser"><em>dojo/parser</em></a> using <tt class="docutils literal"><span class="pre">data-dojo-type=&quot;dojo/dnd/Target&quot;</span></tt>.</p>
</div>
<div class="section" id="autosource">
<h3>AutoSource<a class="headerlink" href="#autosource" title="Permalink to this headline">¶</a></h3>
<p>Essentially it is <a class="reference internal" href="#source">Source</a> wrapped in with <tt class="docutils literal"><span class="pre">autoSync</span></tt> set to <tt class="docutils literal"><span class="pre">true</span></tt>. Instances of this class can be created from the
HTML markup automatically by <a class="reference internal" href="parser.html#dojo-parser"><em>dojo/parser</em></a> using <tt class="docutils literal"><span class="pre">data-dojo-type=&quot;dojo/dnd/AutoSource&quot;</span></tt>.</p>
</div>
<div class="section" id="avatar">
<h3>Avatar<a class="headerlink" href="#avatar" title="Permalink to this headline">¶</a></h3>
<p>Avatar is a class for the object (the singleton pattern) that represents dragged items during DnD operations. You can
replace it or style it if you need to customize the look of DnD.</p>
<p>Following methods should be implemented:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">constructor(manager)</span></tt></dt>
<dd>the constructor of the class takes a single parameter &#8212; the instance of <a class="reference internal" href="#manager">Manager</a>, which is used to reflect the state
of the DnD operation in progress visually. The constructor is called (and the avatar object is created) only when the
manager decided to start a DnD operation. In this case <a class="reference internal" href="#manager">Manager</a> calls its method <tt class="docutils literal"><span class="pre">makeAvatar()</span></tt>. By default Avatar
constructs a <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt> node.</dd>
<dt><tt class="docutils literal"><span class="pre">destroy()</span></tt></dt>
<dd>this method is called when the DnD operation is finished, the Avatar is unneeded, and is about to be recycled.</dd>
<dt><tt class="docutils literal"><span class="pre">update()</span></tt></dt>
<dd>this method is called, when the state of the manager changes. It is used to reflect <a class="reference internal" href="#manager">Manager</a>&#8216;s changes visually.
Usually this method is called by <a class="reference internal" href="#manager">Manager</a> automatically.</dd>
<dt><tt class="docutils literal"><span class="pre">generateText()</span></tt></dt>
<dd>semi-public method, which is called by <tt class="docutils literal"><span class="pre">update()</span></tt> to render the header text. The default implementation returns a
number of dragged items as a string. You can override this method for localization purposes, or to change the text
however you like.</dd>
</dl>
<p>The default implementation of the Avatar class does the following:</p>
<ul class="simple">
<li>It creates an absolutely positioned table of up to 6 rows.</li>
<li>The first row (the header) is populated with a text generated by <tt class="docutils literal"><span class="pre">generateText()</span></tt> method.</li>
<li>Next rows are populated with DOM nodes generated by the creator function of the current source with hint &#8220;avatar&#8221; (see
above the description of the creator function) for data items. Up to 5 rows are populated with decreasing opacity.</li>
</ul>
<p>If you want to override the avatar with something totally custom, the best way to do it is to override <a class="reference internal" href="#manager">Manager</a>&#8216;s
<tt class="docutils literal"><span class="pre">makeAvatar()</span></tt> to return your own instance.</p>
<div class="section" id="id10">
<h4>CSS classes<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used to style the avatar:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndAvatar</span></tt></dt>
<dd>assigned to the avatar (the table).</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndAvatarHeader</span></tt></dt>
<dd>assigned to the first row (the header).</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndAvatarItem</span></tt></dt>
<dd>assigned to the avatar item rows.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndAvatarCanDrop</span></tt></dt>
<dd>added to the avatar (the table) when the mouse is over a target, which can accept transferred items. Otherwise it is
removed.</dd>
</dl>
</div>
</div>
<div class="section" id="manager">
<h3>Manager<a class="headerlink" href="#manager" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">Manager</span></tt> is a class which implements a business logic of DnD and orchestrates the visualization of this process. (It is the replacement for the deprecated <tt class="docutils literal"><span class="pre">dojo.dnd.manager</span></tt> singleton in 1.6.)  It
accepts events from sources/targets, creates the <a class="reference internal" href="#avatar">Avatar</a>, and checks the validity of the drop. At any given moment there
is only one instance of this class (the singleton pattern), which can be accessed by <tt class="docutils literal"><span class="pre">Manager.manager()</span></tt> function.
You do not need to instantiate this object explicitly. It is done automatically when DnD modules are required.</p>
<p>This class or its instance can be monkey patched or replaced completely, if you want to change its functionality.</p>
<div class="section" id="id11">
<h4>Public methods and attributes<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>Following public methods are defined to be called by sources:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">startDrag(source,</span> <span class="pre">nodes,</span> <span class="pre">copy)</span></tt></dt>
<dd><p class="first">starts the DnD operations. The parameters are copied as public member variables of the <tt class="docutils literal"><span class="pre">Manager</span></tt> with the same
names. This method creates the avatar by calling <tt class="docutils literal"><span class="pre">this.makeAvatar()</span></tt> and assigning it to the <tt class="docutils literal"><span class="pre">avatar</span></tt> public
member. Information on parameters:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">source</span></tt></dt>
<dd>the source of dragged items, can be the same object as the target.</dd>
<dt><tt class="docutils literal"><span class="pre">nodes</span></tt></dt>
<dd>the array of DOM nodes to be dropped. Their ids can be used to access associated types and data.</dd>
<dt><tt class="docutils literal"><span class="pre">copy</span></tt></dt>
<dd>the Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the target is requested to copy items, otherwise the target should move items.</dd>
</dl>
</dd>
<dt><tt class="docutils literal"><span class="pre">stopDrag()</span></tt></dt>
<dd>resets the DnD operation by resetting all public members. It is not enough to just call this method to abort the DnD
operation. Before calling it you should publish <tt class="docutils literal"><span class="pre">dnd/cancel</span></tt> topic (or <tt class="docutils literal"><span class="pre">dnd/drop</span></tt>, if your forcing the drop). See
more information on topics below.</dd>
<dt><tt class="docutils literal"><span class="pre">canDrop(flag)</span></tt></dt>
<dd>called by the current target to notify that it can accept the DnD items, if flag is <tt class="docutils literal"><span class="pre">true</span></tt>. Otherwise it refuses to
accept them.</dd>
</dl>
<p>Following methods deal with the avatar and can be overridden, if something different is required:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">makeAvatar()</span></tt></dt>
<dd>returns the <a class="reference internal" href="#avatar">Avatar</a>&#8216;s node. By default it creates an instance of <a class="reference internal" href="#avatar">Avatar</a> passing itself as a parameter.</dd>
<dt><tt class="docutils literal"><span class="pre">updateAvatar()</span></tt></dt>
<dd>updates avatar to reflect changes in the current DnD operation (e.g. copy vs. move) cannot drop at this point.</dd>
</dl>
<p>Following public properties are defined on the manager and can be overwritten if desired:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">OFFSET_X</span></tt></dt>
<dd>the horizontal offset in pixels between the mouse pointer position and the left edge of the avatar.</dd>
<dt><tt class="docutils literal"><span class="pre">OFFSET_Y</span></tt></dt>
<dd>the vertical offset in pixels between the mouse pointer position and the top edge of the avatar.</dd>
</dl>
<p>Following public properties are used by the manager during the active DnD operation:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">source</span></tt></dt>
<dd>the source of DnD items.</dd>
<dt><tt class="docutils literal"><span class="pre">nodes</span></tt></dt>
<dd>the list of transferred DnD items.</dd>
<dt><tt class="docutils literal"><span class="pre">copy</span></tt></dt>
<dd>Boolean value to track the copy/move status.</dd>
<dt><tt class="docutils literal"><span class="pre">target</span></tt></dt>
<dd>the selected target of the drop.</dd>
</dl>
</div>
<div class="section" id="id12">
<h4>Event processors<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>Following events are processed by the manager to the body: <tt class="docutils literal"><span class="pre">onMouseMove</span></tt>, <tt class="docutils literal"><span class="pre">onMouseUp</span></tt>, <tt class="docutils literal"><span class="pre">onKeyDown</span></tt>, <tt class="docutils literal"><span class="pre">onKeyUp</span></tt>.
These events are attached only during the active DnD operation. Following keys have a special meaning for the manager:</p>
<dl class="docutils">
<dt><em>Ctrl</em> key</dt>
<dd>when it is pressed the copy semantics is assumed. Otherwise the move is assumed.</dd>
<dt><em>Esc</em> key</dt>
<dd>when it is pressed the DnD operation is immediately canceled.</dd>
</dl>
</div>
<div class="section" id="id13">
<h4>Topic processors<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>Following topic events can be generated by the manager:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">/dnd/start</span></tt></dt>
<dd>when DnD starts. Current <tt class="docutils literal"><span class="pre">source</span></tt>, <tt class="docutils literal"><span class="pre">nodes</span></tt>, and the <tt class="docutils literal"><span class="pre">copy</span></tt> flag (see <tt class="docutils literal"><span class="pre">startDrag()</span></tt> for more info) are passed
as parameters of this event.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/source/over</span></tt></dt>
<dd>when the mouse moves over a source. The source in question is passed as a parameter. The same event is raised when the
mouse goes out of a source. In this case <tt class="docutils literal"><span class="pre">null</span></tt> is passed as a parameter.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/drop/before</span></tt></dt>
<dd>raised just before the drop. It can be used to capture the drop parameters. Parameters are the same as for
<tt class="docutils literal"><span class="pre">/dnd/start</span></tt>, but reflect current values.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/drop</span></tt></dt>
<dd>raised to perform a drop. Parameters are the same as for <tt class="docutils literal"><span class="pre">/dnd/start</span></tt> and one additional parameter is <tt class="docutils literal"><span class="pre">target</span></tt>
(the object where items are dropped).</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/cancel</span></tt></dt>
<dd>when DnD was canceled either by user (by hitting <em>Esc</em>), or by dropping items in illegal location.</dd>
</dl>
<p><strong>Warning:</strong> During the processing of topics any listener can change the original parameters. It can be done by the
target processing <tt class="docutils literal"><span class="pre">/dnd/drop</span></tt>. In most cases you want to use events local to sources/targets, instead of processing
topics. See <a class="reference internal" href="#source">Source</a>&#8216;s <tt class="docutils literal"><span class="pre">onDrop</span></tt> for more details.</p>
</div>
<div class="section" id="id14">
<h4>CSS classes<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by the manager to style the DnD operation:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndCopy</span></tt></dt>
<dd>assigned to <tt class="docutils literal"><span class="pre">body</span></tt> during the copy DnD operations.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndMove</span></tt></dt>
<dd>assigned to <tt class="docutils literal"><span class="pre">body</span></tt> during the move DnD operations.</dd>
</dl>
<p>No styles are assigned when there is no DnD in progress.</p>
</div>
</div>
</div>
<div class="section" id="dojo-dnd-move-principals">
<h2><a class="toc-backref" href="#id28">dojo/dnd/move Principals</a><a class="headerlink" href="#dojo-dnd-move-principals" title="Permalink to this headline">¶</a></h2>
<p>The DnD move consists of two principal classes and several specific implementations.</p>
<div class="section" id="moveable">
<h3>Moveable<a class="headerlink" href="#moveable" title="Permalink to this headline">¶</a></h3>
<p>Moveable is the main class, which is used to give the &#8220;moveable&#8221; property to a DOM node. Instances of this class can be
created from the HTML markup automatically by <a class="reference internal" href="parser.html#dojo-parser"><em>dojo/parser</em></a> using
<tt class="docutils literal"><span class="pre">data-dojo-type=&quot;dojo/dnd/Moveable&quot;</span></tt>.</p>
<div class="section" id="id15">
<h4>Constructor<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>The constructor accepts following parameters:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">node</span></tt></dt>
<dd>a DOM node or a String representing an ID of a node. This node will be made moveable. Both <tt class="docutils literal"><span class="pre">relative</span></tt> and
<tt class="docutils literal"><span class="pre">absolute</span></tt> nodes can be moved. Their <tt class="docutils literal"><span class="pre">left</span></tt> and <tt class="docutils literal"><span class="pre">top</span></tt> are assumed to be in pixels. All other nodes are converted
to <tt class="docutils literal"><span class="pre">absolute</span></tt> nodes on the first drag.</dd>
<dt><tt class="docutils literal"><span class="pre">params</span></tt></dt>
<dd><p class="first">a dictionary object, which defines optional parameters. Following optional parameters are recognized:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">handle</span></tt></dt>
<dd>the node (or its String ID), which will be used as a drag handle. It should be a descendant of <tt class="docutils literal"><span class="pre">node</span></tt>. If it is
<tt class="docutils literal"><span class="pre">null</span></tt> (the default), the <tt class="docutils literal"><span class="pre">node</span></tt> itself is used for dragging.</dd>
<dt><tt class="docutils literal"><span class="pre">delay</span></tt></dt>
<dd>a number in pixels. When user started the drag we should wait for <tt class="docutils literal"><span class="pre">delay</span></tt> pixels before starting dragging the
node. It is used to prevent accidental drags. The default is 0 (no delay).</dd>
<dt><tt class="docutils literal"><span class="pre">skip</span></tt></dt>
<dd>a Boolean flag, which indicates that we should skip form elements when initiating drags if it is <tt class="docutils literal"><span class="pre">true</span></tt>. Otherwise
the node is dragged no matter what. This parameter is used when we want to drag a form, but keep form elements
usable (e.g. we can still select text in a text node). The default is <tt class="docutils literal"><span class="pre">false</span></tt>. When working with a draggable form,
the better alternative to <tt class="docutils literal"><span class="pre">skip=true</span></tt> is to define a drag handle instead.</dd>
<dt><tt class="docutils literal"><span class="pre">mover</span></tt></dt>
<dd>the class to be used to create a mover (see <a class="reference internal" href="#mover">Mover</a>).</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="id16">
<h4>Public methods and attributes<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>Following public attributes are available:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">node</span></tt></dt>
<dd>the node to be dragged.</dd>
</dl>
<p>Following public methods are defined:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">destroy()</span></tt></dt>
<dd>should be called when you want to remove the &#8220;moveable&#8221; behavior form the node.</dd>
</dl>
</div>
<div class="section" id="id17">
<h4>Event processors<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h4>
<p>Following public methods/events are defined. They can be used with <em class="xref std std-ref">dojo.connect()</em> or overridden:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">onDragDetected(evt)</span></tt></dt>
<dd><p class="first">called when the drag is detected. The default implementation creates a <a class="reference internal" href="#mover">Mover</a>. Parameters:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">evt</span></tt></dt>
<dd>the event object, which triggered the drag.</dd>
</dl>
</dd>
<dt><tt class="docutils literal"><span class="pre">onFirstMove(mover)</span></tt></dt>
<dd><p class="first">called once after processing the first move event. The default implementation does nothing. Parameters:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">mover</span></tt></dt>
<dd>the <a class="reference internal" href="#mover">Mover</a> object used to drag the node</dd>
</dl>
</dd>
<dt><tt class="docutils literal"><span class="pre">onMoveStart(mover)</span></tt></dt>
<dd>called when the move is about to start. The parameter is a <a class="reference internal" href="#mover">Mover</a> object just like in <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt>. The default
implementation publishes the topic <tt class="docutils literal"><span class="pre">/dnd/move/start</span></tt>, adds <tt class="docutils literal"><span class="pre">dojoMove</span></tt> class to <tt class="docutils literal"><span class="pre">body</span></tt> node, and <tt class="docutils literal"><span class="pre">dojoMoveItem</span></tt>
class to the moved node.</dd>
<dt><tt class="docutils literal"><span class="pre">onMoveStop(mover)</span></tt></dt>
<dd>called when the move is finished. The parameter is a <a class="reference internal" href="#mover">Mover</a> object just like in <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt>. The default
implementation publishes the topic <tt class="docutils literal"><span class="pre">/dnd/move/stop</span></tt>, removes <tt class="docutils literal"><span class="pre">dojoMove</span></tt> class from <tt class="docutils literal"><span class="pre">body</span></tt> node, and
<tt class="docutils literal"><span class="pre">dojoMoveItem</span></tt> class from the moved node.</dd>
<dt><tt class="docutils literal"><span class="pre">onMove(mover,</span> <span class="pre">leftTop)</span></tt></dt>
<dd><p class="first">called on every update of <tt class="docutils literal"><span class="pre">node</span></tt>&#8216;s position. The default implementation calls <tt class="docutils literal"><span class="pre">onMoving()</span></tt>, sets new position of
the <tt class="docutils literal"><span class="pre">node</span></tt> using <tt class="docutils literal"><span class="pre">style</span></tt>, and calls <tt class="docutils literal"><span class="pre">onMoved()</span></tt>. Parameters:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">mover</span></tt></dt>
<dd>the <a class="reference internal" href="#mover">Mover</a> object for the current move.</dd>
<dt><tt class="docutils literal"><span class="pre">leftTop</span></tt></dt>
<dd><tt class="docutils literal"><span class="pre">{l,</span> <span class="pre">t}</span></tt> – an object which defines the new left and top position of the object by its attributes <tt class="docutils literal"><span class="pre">l</span></tt> and <tt class="docutils literal"><span class="pre">t</span></tt>
respectively. Both of them are numbers in pixels.</dd>
</dl>
</dd>
<dt><tt class="docutils literal"><span class="pre">onMoving(mover,</span> <span class="pre">leftTop)</span></tt></dt>
<dd>called by the default implementation of <tt class="docutils literal"><span class="pre">onMove()</span></tt> before updating the <tt class="docutils literal"><span class="pre">node</span></tt>&#8216;s position. It uses the same
parameters as <tt class="docutils literal"><span class="pre">onMove()</span></tt> above. You can update <tt class="docutils literal"><span class="pre">leftTop</span></tt> parameter to whatever you want. The default
implementation does nothing.</dd>
<dt><tt class="docutils literal"><span class="pre">onMoved(mover,</span> <span class="pre">leftTop)</span></tt></dt>
<dd>called by the default implementation of <tt class="docutils literal"><span class="pre">onMove()</span></tt> after updating the <tt class="docutils literal"><span class="pre">node</span></tt>&#8216;s position. It uses the same
parameters as <tt class="docutils literal"><span class="pre">onMove()</span></tt> above. The default implementation does nothing.</dd>
</dl>
<p>The most important events are <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt> and <tt class="docutils literal"><span class="pre">onMove()</span></tt>. <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt> can be used to set up some initial
parameters for the move, and possibly update some DOM nodes. <tt class="docutils literal"><span class="pre">onMove()</span></tt> implements the move itself. By overriding
these two methods you can implement a variety of click-drag-release operations (e.g. a resize operation, a draw
operation, and so on).</p>
<p>As you can see <tt class="docutils literal"><span class="pre">onMoving()</span></tt>, <tt class="docutils literal"><span class="pre">onMove()</span></tt>, and <tt class="docutils literal"><span class="pre">onMoved()</span></tt> fit the classic aspect before/after pattern.
<tt class="docutils literal"><span class="pre">onMoving()</span></tt> can be used to actively modify move parameters, while <tt class="docutils literal"><span class="pre">onMoved()</span></tt> can be used for book-keeping. You may
want to override <tt class="docutils literal"><span class="pre">onMove()</span></tt> for your own purposes and use <a class="reference internal" href="aspect.html#dojo-aspect"><em>dojo/aspect</em></a> to augment it however you
like.</p>
<p>Following mouse event handlers are set up:</p>
<p><tt class="docutils literal"><span class="pre">onMouseDown</span></tt></p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">onMouseMove</span></tt></dt>
<dd>can be set up by <tt class="docutils literal"><span class="pre">onMouseDown</span></tt> when executing the non-zero delay.</dd>
<dt><tt class="docutils literal"><span class="pre">onMouseUp</span></tt></dt>
<dd>can be set up by <tt class="docutils literal"><span class="pre">onMouseDown</span></tt> to cancel the drag while processing the non-zero delay.</dd>
</dl>
<p>Additionally <tt class="docutils literal"><span class="pre">ondragselect</span></tt> and <tt class="docutils literal"><span class="pre">onselectstart</span></tt> events are canceled by <tt class="docutils literal"><span class="pre">onSelectStart()</span></tt> handler.</p>
</div>
<div class="section" id="id18">
<h4>Topic processors<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p>Following topic events are raised by <a class="reference internal" href="#moveable">Moveable</a>:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">/dnd/move/start</span></tt></dt>
<dd>published by the default implementation of <tt class="docutils literal"><span class="pre">onMoveStart()</span></tt> passing the <a class="reference internal" href="#mover">Mover</a> object as a parameter.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/move/stop</span></tt></dt>
<dd>published by the default implementation of <tt class="docutils literal"><span class="pre">onMoveStop()</span></tt> passing the <a class="reference internal" href="#mover">Mover</a> as a parameter.</dd>
</dl>
</div>
<div class="section" id="id19">
<h4>CSS classes<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by <a class="reference internal" href="#moveable">Moveable</a>:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoMove</span></tt></dt>
<dd>assigned to <tt class="docutils literal"><span class="pre">body</span></tt> when the move is in progress.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoMoveItem</span></tt></dt>
<dd>assigned to the moved node when the move is in progress.</dd>
</dl>
</div>
</div>
<div class="section" id="mover">
<h3>Mover<a class="headerlink" href="#mover" title="Permalink to this headline">¶</a></h3>
<p>Mover is a utility class, which handles events to move the node, and triggers appropriate high-level events on the
connected object (usually a <a class="reference internal" href="#moveable">Moveable</a>). Instances of this class exist only when the move is in progress. In some cases
you can use it directly.</p>
<div class="section" id="id20">
<h4>Constructor<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>The constructor accepts following parameters:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">node</span></tt></dt>
<dd>a DOM node or an id (string) of such node. This node will be moved.</dd>
<dt><tt class="docutils literal"><span class="pre">evt</span></tt></dt>
<dd>a mouse event, which actually indicated the start of the move. It is used to extract the coordinates of the mouse
using <tt class="docutils literal"><span class="pre">pageX</span></tt> and <tt class="docutils literal"><span class="pre">pageY</span></tt> properties.</dd>
<dt><tt class="docutils literal"><span class="pre">host</span></tt></dt>
<dd>a host object, which will be called by the mover during the move. It should define at least two methods:
<tt class="docutils literal"><span class="pre">onFirstMove()</span></tt>, and <tt class="docutils literal"><span class="pre">onMove()</span></tt>, and two optional methods: <tt class="docutils literal"><span class="pre">onMoveStart()</span></tt> and <tt class="docutils literal"><span class="pre">onMoveStop()</span></tt>. See <a class="reference internal" href="#moveable">Moveable</a>
for details.</dd>
</dl>
</div>
<div class="section" id="id21">
<h4>Public methods and attributes<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>Following public members are available:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">node</span></tt></dt>
<dd>the node being dragged.</dd>
<dt><tt class="docutils literal"><span class="pre">mouseButton</span></tt></dt>
<dd>a mouse button, which was pressed when starting the drag.</dd>
<dt><tt class="docutils literal"><span class="pre">marginBox</span></tt></dt>
<dd>an object with two integer attributes: <tt class="docutils literal"><span class="pre">l</span></tt> and <tt class="docutils literal"><span class="pre">t</span></tt>. It is initialized by the constructor, updated by the
<tt class="docutils literal"><span class="pre">onFirstMove()</span></tt> method on the mover, and used later on to add to the mouse coordinates before passing them to host&#8217;s
<tt class="docutils literal"><span class="pre">onMove()</span></tt> as <tt class="docutils literal"><span class="pre">leftTop</span></tt>.</dd>
</dl>
<p>Following public methods are defined:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">destroy()</span></tt></dt>
<dd>should be called when you want to stop the move.</dd>
<dt><tt class="docutils literal"><span class="pre">onFirstMove()</span></tt></dt>
<dd>called once to finish setting up the <tt class="docutils literal"><span class="pre">marginBox</span></tt> property. Additionally it calls the host&#8217;s <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt>.</dd>
</dl>
</div>
<div class="section" id="id22">
<h4>Event processors<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>Following mouse event handlers are set up: <tt class="docutils literal"><span class="pre">onMouseMove</span></tt>, <tt class="docutils literal"><span class="pre">onMouseUp</span></tt>. Additionally <tt class="docutils literal"><span class="pre">ondragselect</span></tt> and
<tt class="docutils literal"><span class="pre">onselectstart</span></tt> events are canceled.</p>
</div>
</div>
<div class="section" id="specialized-moveables">
<h3>Specialized Moveables<a class="headerlink" href="#specialized-moveables" title="Permalink to this headline">¶</a></h3>
<p>Following specialized moveable classes are defined:</p>
<div class="section" id="constrainedmoveable">
<h4>constrainedMoveable<a class="headerlink" href="#constrainedmoveable" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">dojo/dnd/move/constrainedMoveable</span></tt> can be used to constrain a move to a dynamically calculated box. This class is
defined in the <tt class="docutils literal"><span class="pre">dojo/dnd/move</span></tt> module. It is based on <a class="reference internal" href="#moveable">Moveable</a>, and accepts following additional parameters during
construction:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">constraints</span></tt></dt>
<dd>a function, which is called in the context of this <a class="reference internal" href="#moveable">Moveable</a>, with a newly created <a class="reference internal" href="#mover">Mover</a> object, and returns a
rectangle to be used for restrictions. The rectangle is an object, which defines following numeric attributes: <tt class="docutils literal"><span class="pre">l</span></tt>
for left, <tt class="docutils literal"><span class="pre">t</span></tt> for top, <tt class="docutils literal"><span class="pre">w</span></tt> for width, and <tt class="docutils literal"><span class="pre">h</span></tt> for height. All numbers are in pixels.</dd>
<dt><tt class="docutils literal"><span class="pre">within</span></tt></dt>
<dd>a Boolean flag. When it is <tt class="docutils literal"><span class="pre">true</span></tt>, the dragged node will be moved only within the defined rectangle, and cannot go
outside of it. Otherwise, the restriction applies to the left-top corner of the moved node.</dd>
</dl>
</div>
<div class="section" id="boxconstrainedmoveable">
<h4>boxConstrainedMoveable<a class="headerlink" href="#boxconstrainedmoveable" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">dojo/dnd/move/boxConstrainedMoveable</span></tt> can be used to constrain a move to a predefined box. This class is defined in
the <tt class="docutils literal"><span class="pre">dojo/dnd/move</span></tt> module. It is based on <a class="reference internal" href="#constrainedmoveable">constrainedMoveable</a> and accepts following additional parameters during
construction:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">box</span></tt></dt>
<dd>a rectangle box (see <a class="reference internal" href="#constrainedmoveable">constrainedMoveable</a>), which defines constraint boundaries.</dd>
<dt><tt class="docutils literal"><span class="pre">within</span></tt></dt>
<dd>see <a class="reference internal" href="#constrainedmoveable">constrainedMoveable</a> for details.</dd>
</dl>
</div>
<div class="section" id="parentconstrainedmoveable">
<h4>parentConstrainedMoveable<a class="headerlink" href="#parentconstrainedmoveable" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">dojo/dnd/move/parentConstrainedMoveable</span></tt> can be used to constrain the move by the boundaries of the node&#8217;s parent.
This class is defined in the <tt class="docutils literal"><span class="pre">dojo/dnd/move</span></tt> module. It is based on <a class="reference internal" href="#constrainedmoveable">constrainedMoveable</a> and accepts following
additional parameters during construction:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">area</span></tt></dt>
<dd>a string, which defines constraint boundaries. Valid values are: <tt class="docutils literal"><span class="pre">&quot;content&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;padding&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;border&quot;</span></tt>, and
<tt class="docutils literal"><span class="pre">&quot;margin&quot;</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">within</span></tt></dt>
<dd>see <a class="reference internal" href="#constrainedmoveable">constrainedMoveable</a> for details.</dd>
</dl>
</div>
<div class="section" id="timedmoveable">
<h4>TimedMoveable<a class="headerlink" href="#timedmoveable" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">dojo/dnd/TimedMoveable</span></tt> can be used to throttle refreshes while moving nodes. This class is defined in its own module. It is based on <a class="reference internal" href="#moveable">Moveable</a>, and accepts following additional parameters during construction:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">timeout</span></tt></dt>
<dd>the time delay number in milliseconds. The node will not be moved for that number of milliseconds, but it will
continue to accumulate changes in the mouse position.</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="subclassing-dnd-classes">
<h2><a class="toc-backref" href="#id29">Subclassing DnD classes</a><a class="headerlink" href="#subclassing-dnd-classes" title="Permalink to this headline">¶</a></h2>
<p>If you want to subclass <a class="reference internal" href="#container">Container</a>, <a class="reference internal" href="#selector">Selector</a>, <a class="reference internal" href="#source">Source</a>, <a class="reference internal" href="#moveable">Moveable</a>, or their descendants, and you want to use the
declarative markup, don&#8217;t forget to implement the <tt class="docutils literal"><span class="pre">markupFactory()</span></tt> method. The reason for that is <a class="reference internal" href="parser.html#dojo-parser"><em>dojo/parser</em></a>, which instantiates the markup, expects a very particular signature from a constructor. Dojo DnD classes
predate <tt class="docutils literal"><span class="pre">dojo/parser</span></tt>, and have a non-conformant signature. <tt class="docutils literal"><span class="pre">dojo/parser</span></tt> is smart enough to use a special adapter
function in such cases. See the source code for <tt class="docutils literal"><span class="pre">dojo/dnd/Source::markupFactory()</span></tt> (for the
<a class="reference internal" href="#container">Container</a>-<a class="reference internal" href="#selector">Selector</a>-<a class="reference internal" href="#source">Source</a> chain), and <tt class="docutils literal"><span class="pre">dojo/dnd/Moveable::markupFactory()</span></tt> for details. The key point is to return
the instance of your new class there. Otherwise the instance of your base class is going to be created, which is
probably not what you want.</p>
</div>
<div class="section" id="summary-of-css-classes">
<h2><a class="toc-backref" href="#id30">Summary of CSS classes</a><a class="headerlink" href="#summary-of-css-classes" title="Permalink to this headline">¶</a></h2>
<p>All DnD-related classes can be used on six different types of DOM nodes. All of them are listed here. Using CSS classes
described here you can design an extremely sophisticated UI to improve usability and enhance the workflow of your
applications.</p>
<div class="section" id="body">
<h3>body<a class="headerlink" href="#body" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">body</span></tt> node is updated only during active DnD operations. It can be used during the move to de-emphasize
temporarily the web page and to highlight available targets or a moved object.</p>
<p>Following CSS classes are used:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndCopy</span></tt></dt>
<dd>assigned to the <tt class="docutils literal"><span class="pre">body</span></tt> during the copy DnD operations.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndMove</span></tt></dt>
<dd>assigned to the <tt class="docutils literal"><span class="pre">body</span></tt> during the move DnD operations.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoMove</span></tt></dt>
<dd>assigned to the <tt class="docutils literal"><span class="pre">body</span></tt> when the drag (<tt class="docutils literal"><span class="pre">dojo/dnd/move</span></tt>) is in progress.</dd>
</dl>
</div>
<div class="section" id="source-target-dojo-dnd">
<h3>Source/target (dojo/dnd)<a class="headerlink" href="#source-target-dojo-dnd" title="Permalink to this headline">¶</a></h3>
<p>Source can be assigned several classes to reflect its current role. These classes can be used together with the body CSS
classes described above to create CSS rules to differentiate containers visually during DnD.</p>
<p>Following CSS classes are used:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndContainer</span></tt></dt>
<dd>assigned to each container node during the construction.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndContainerOver</span></tt></dt>
<dd>assigned when the mouse hovers over the container.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndHorizontal</span></tt></dt>
<dd>assigned to the container node during the construction, if this object represents a horizontal list of DnD items
its <tt class="docutils literal"><span class="pre">horizontal</span></tt> property set to <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndSource</span></tt></dt>
<dd>assigned to the container node during the construction, if this object can be used as a source of DnD items its
<tt class="docutils literal"><span class="pre">isSource</span></tt> property set to <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndSourceCopied</span></tt></dt>
<dd>assigned to the container node during the active DnD operation when user copies items from it (e.g. the <em>Ctrl</em> key was
pressed while dragging). When this class is assigned to the node <tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> class is removed.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndSourceMoved</span></tt></dt>
<dd>assigned to the container node during the active DnD operation when user moves items from it (e.g. the Ctrl key is not
pressed while dragging). When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> class is removed.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt></dt>
<dd>assigned to the container node during the construction, if this object can potentially accept DnD items its <tt class="docutils literal"><span class="pre">accept</span></tt>
array is not empty.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndTargetDisabled</span></tt></dt>
<dd>assigned to the container node during the active DnD operation when this node cannot accept currently dragged items
(e.g., because it doesn&#8217;t accept items of these types). When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt>
class is removed.</dd>
</dl>
</div>
<div class="section" id="dnd-item-dojo-dnd">
<h3>DnD Item (dojo/dnd)<a class="headerlink" href="#dnd-item-dojo-dnd" title="Permalink to this headline">¶</a></h3>
<p>DnD items can be assigned several classes to reflect their current role visually.</p>
<p>Following CSS classes are used:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndItem</span></tt></dt>
<dd>assigned to every new data item node. It should be assigned to every item before the container construction, if you
want it to be added automatically by the constructor or <tt class="docutils literal"><span class="pre">sync()</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemOver</span></tt></dt>
<dd>assigned to a data item node when the mouse hovers over the this item. This class is assigned in addition to
<tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemSelected</span></tt></dt>
<dd>assigned if a data item is selected but it is not an anchor (the last selected element). This class is assigned in
addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemAnchor</span></tt></dt>
<dd>assigned to an anchor data item. At any given time the selector can have zero or one anchor. This class is assigned in
addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class. Being an anchor means that this item is selected.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemBefore</span></tt></dt>
<dd>assigned to the data item node during the active DnD operation if transferred items will be inserted before this item.
This class is assigned in addition to all other classes.</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndItemAfter</span></tt></dt>
<dd>assigned to the data item node during the active DnD operation if transferred items will be inserted after this item.
This class is assigned in addition to all other classes.</dd>
</dl>
</div>
<div class="section" id="dnd-handles-dojo-dnd">
<h3>DnD Handles (dojo/dnd)<a class="headerlink" href="#dnd-handles-dojo-dnd" title="Permalink to this headline">¶</a></h3>
<p>DnD items can defined special handles on their descendants, which can be used for dragging. In this case the body of the
DnD item cannot be used to start the drag.</p>
<p>Following CSS classes are used:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndHandle</span></tt></dt>
<dd>assigned to handles of item nodes. See the <tt class="docutils literal"><span class="pre">withHandles</span></tt> parameter of <a class="reference internal" href="#source">Source</a>.</dd>
</dl>
</div>
<div class="section" id="avatar-dojo-dnd">
<h3>Avatar (dojo/dnd)<a class="headerlink" href="#avatar-dojo-dnd" title="Permalink to this headline">¶</a></h3>
<p>The default avatar can be styled to suit your needs.</p>
<p>Following CSS classes are used:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoDndAvatar</span></tt></dt>
<dd>assigned to the avatar node (the table).</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndAvatarHeader</span></tt></dt>
<dd>assigned to the first row/the header (the first <tt class="docutils literal"><span class="pre">tr</span></tt> node).</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndAvatarItem</span></tt></dt>
<dd>assigned to the avatar item rows (<tt class="docutils literal"><span class="pre">tr</span></tt> nodes excluding the very first one).</dd>
<dt><tt class="docutils literal"><span class="pre">dojoDndAvatarCanDrop</span></tt></dt>
<dd>added to the avatar node (the table) when the mouse is over a target, which can accept transferred items. Otherwise it
is removed.</dd>
</dl>
</div>
<div class="section" id="dragged-node-dojo-dnd-move">
<h3>Dragged node (dojo.dnd.move)<a class="headerlink" href="#dragged-node-dojo-dnd-move" title="Permalink to this headline">¶</a></h3>
<p>The dragged node can be specially styled while in move.</p>
<p>Following CSS classes are used:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dojoMoveItem</span></tt></dt>
<dd>assigned to the dragged node when the move is in progress.</dd>
</dl>
</div>
</div>
<div class="section" id="summary-of-topics">
<h2><a class="toc-backref" href="#id31">Summary of <tt class="docutils literal"><span class="pre">topics</span></tt></a><a class="headerlink" href="#summary-of-topics" title="Permalink to this headline">¶</a></h2>
<p>While local events are the preferred way to handle state changes, in some cases topics (named global events) can be
used. <strong>Note</strong> Please double-check if you have to use topics instead of events.</p>
<p>Following topic events can be generated by <a class="reference internal" href="#manager">Manager</a>:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">/dnd/start</span></tt></dt>
<dd>when DnD starts. Current <tt class="docutils literal"><span class="pre">source</span></tt>, <tt class="docutils literal"><span class="pre">nodes</span></tt>, and <tt class="docutils literal"><span class="pre">copy</span></tt> flag (see <a class="reference internal" href="#manager">Manager</a>&#8216;s <tt class="docutils literal"><span class="pre">startDrag()</span></tt> for more info) are
passed as parameters of this event.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/source/over</span></tt></dt>
<dd>when the mouse moves over a source. The source in question is passed as a parameter. The same event is raised when the
mouse goes out of a source. In this case <tt class="docutils literal"><span class="pre">null</span></tt> is passed as a parameter.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/drop/before</span></tt></dt>
<dd>raised just before the drop. It can be used to capture the drop parameters. Parameters are the same as for
<tt class="docutils literal"><span class="pre">/dnd/drop</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/drop</span></tt></dt>
<dd>raised to perform a drop. The first three parameters are the same as for <tt class="docutils literal"><span class="pre">/dnd/start</span></tt>. The fourth parameter is the
target object. Note that during the processing of this event nodes can be already moved, or reused. If you need the
original nodes, use <tt class="docutils literal"><span class="pre">/dnd/drop/before</span></tt> to capture them, or use events local to source/target objects.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/cancel</span></tt></dt>
<dd>when DnD was cancelled either by user (by hitting Esc), or by dropping items in illegal location. This topic has no
parameters.</dd>
</dl>
<p>All sources subscribe to <a class="reference internal" href="#manager">Manager</a>&#8216;s topics. Some users fail to understand that if they override, say, <tt class="docutils literal"><span class="pre">onDndDrop()</span></tt>
method, which is a <tt class="docutils literal"><span class="pre">/dnd/drop</span></tt> topic listener, it will be called <strong>every time</strong> <tt class="docutils literal"><span class="pre">/dnd/drop</span></tt> is signalled. It means
it will be notified even if your source was not the part of the DnD exchange. It wasn&#8217;t a source of the items, and it is
not a target of the drop. If you subclass <a class="reference internal" href="#source">Source</a> and override <tt class="docutils literal"><span class="pre">onDndDrop()</span></tt>, your new method will be called for every
instance of your class.</p>
<p>Following topic events are raised by <a class="reference internal" href="#moveable">Moveable</a>:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">/dnd/move/start</span></tt></dt>
<dd>published by the default implementation of <a class="reference internal" href="#moveable">Moveable</a>&#8216;s <tt class="docutils literal"><span class="pre">onMoveStart()</span></tt> passing a <a class="reference internal" href="#mover">mover</a> as parameter.</dd>
<dt><tt class="docutils literal"><span class="pre">/dnd/move/stop</span></tt></dt>
<dd>published by the default implementation of <a class="reference internal" href="#moveable">Moveable</a>&#8216;s <tt class="docutils literal"><span class="pre">onMoveStop()</span></tt> passing a mover as parameter.</dd>
</dl>
</div>
<div class="section" id="tips">
<h2><a class="toc-backref" href="#id32">Tips</a><a class="headerlink" href="#tips" title="Permalink to this headline">¶</a></h2>
<p>In order to limit the maximum number of items in a DnD source, you can override the <tt class="docutils literal"><span class="pre">checkAcceptance()</span></tt> method on your
source, and return <tt class="docutils literal"><span class="pre">false</span></tt>, when you reached your limit.</p>
<p>If you want to create <tt class="docutils literal"><span class="pre">dojo/dnd/Source</span></tt> declaratively, and want to select that Source for operations like
<tt class="docutils literal"><span class="pre">insertNodes()</span></tt>, you will need to manually supply that <a class="reference internal" href="#source">Source</a> with a <tt class="docutils literal"><span class="pre">data-dojo-id</span></tt>. For example:</p>
<div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">data-dojo-type=</span><span class="s">&quot;dojo/dnd/Source&quot;</span> <span class="na">id=</span><span class="s">&quot;test&quot;</span> <span class="na">data-dojo-id=</span><span class="s">&quot;test&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</pre></div>
<div class="CodeGlassMiniRaw" label="" lang="html"><textarea style="display:none">&lt;div data-dojo-type=&quot;dojo/dnd/Source&quot; id=&quot;test&quot; data-dojo-id=&quot;test&quot;&gt;&lt;/div&gt;</textarea></div><p>Then you reference it in your code like: <tt class="docutils literal"><span class="pre">test.insertNodes();</span></tt>. Without that, there is no way to use the methods of
the <a class="reference internal" href="#source">Source</a> if you are creating it with markup.</p>
<p>The DnD itself uses <tt class="docutils literal"><span class="pre">onmousedown</span></tt>/<tt class="docutils literal"><span class="pre">onmousemove</span></tt>/<tt class="docutils literal"><span class="pre">onmouseup</span></tt> to operate. If you want to process <tt class="docutils literal"><span class="pre">onclick</span></tt>, be
warned that this is the synthetic event: essentially it is <tt class="docutils literal"><span class="pre">onmousedown</span> <span class="pre">+</span> <span class="pre">onmouseup</span></tt>, which occurred within some
predefined time interval (usually settable on the OS level), or using other criteria. Some browsers generate <tt class="docutils literal"><span class="pre">onclick</span></tt>
on every <tt class="docutils literal"><span class="pre">onmouseup</span></tt>. Working with DnD you will get plenty of false <tt class="docutils literal"><span class="pre">onclick</span></tt> events. Some of them happen naturally,
when user decided to drag but changed her mind clicking the mouse button generating <tt class="docutils literal"><span class="pre">onclick</span></tt>. <em>Be extra careful when
processing</em> <tt class="docutils literal"><span class="pre">onclick</span></tt> <em>on DnD sources!</em></p>
</div>
<div class="section" id="accessibility">
<h2><a class="toc-backref" href="#id33">Accessibility</a><a class="headerlink" href="#accessibility" title="Permalink to this headline">¶</a></h2>
<div class="section" id="low-vision">
<h3>Low Vision<a class="headerlink" href="#low-vision" title="Permalink to this headline">¶</a></h3>
<p>The DnD Icons are specifically designed to be useful in a low vision situation, where color is not the only indication
of what is occurring with DnD operation. The follow icons are used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Image</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><img alt="../_images/dndCopy.png" class="first last" src="../_images/dndCopy.png" />
</td>
<td>If the copy operation can be performed the DnD icon is a green background with a plus.</td>
</tr>
<tr class="row-odd"><td><img alt="../_images/dndNoCopy.png" class="first last" src="../_images/dndNoCopy.png" />
</td>
<td>If the copy operation can not be performed, the DnD icon is a red background with an x.</td>
</tr>
<tr class="row-even"><td><img alt="../_images/dndMove.png" class="first last" src="../_images/dndMove.png" />
</td>
<td>If the move operation can be performed the DnD icon is a green background with an arrow.</td>
</tr>
<tr class="row-odd"><td><img alt="../_images/dndNoMove.png" class="first last" src="../_images/dndNoMove.png" />
</td>
<td>If the move operation can not be performed the DnD icon is a red background with a dash.</td>
</tr>
</tbody>
</table>
<p>For High Contrast mode in Windows or when images have been turned off in the browser, the following character
representations are used for the DnD operations:</p>
<ul class="simple">
<li>If the copy operation can be performed the DnD character is a +.</li>
<li>If the copy operation can not be performed, the DnD is an x.</li>
<li>If the move operation can be performed the DnD character is a &lt;.</li>
<li>If the move operation can not be performed the DnD character is an o.</li>
</ul>
</div>
</div>
<div class="section" id="see-also">
<h2><a class="toc-backref" href="#id34">See also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://www.sitepen.com/blog/2011/12/05/dojo-drag-n-drop-redux/">Dojo Drag And Drop Redux</a> by Colin Snover at
<a class="reference external" href="http://www.sitepen.com/">SitePen</a>. – The comprehensive explanation of <tt class="docutils literal"><span class="pre">dojo/dnd</span></tt>, and how to leverage it in real
applications. The author builds the &#8220;shopping cart&#8221; in several iterations commenting code snippets and providing full
source code for all examples. The only drawback is: this article uses topic handlers, because it was published before
the introduction of local events.</li>
<li><a class="reference external" href="http://www.sitepen.com/blog/2008/10/24/inside-dojo-dnd-drag-handles/">Inside Dojo DnD: Drag Handles</a> by <a class="reference external" href="http://lazutkin.com/">Eugene Lazutkin</a> at <a class="reference external" href="http://www.sitepen.com/">SitePen</a>. – The article explains a frequently
overlooked and underused feature of Dojo’s DnD system: drag handles. It features several simple
examples and clarifies some fine points.</li>
<li><a class="reference external" href="http://www.sitepen.com/blog/2009/04/16/queued-drag-and-drop-in-the-queue/">Queued: Drag and Drop in the Queue</a> by
Bryan Forbes at <a class="reference external" href="http://www.sitepen.com/">SitePen</a>. – The article shows how Dojo&#8217;s DnD was used to implement the
Netflix movie queue reordering feature in Queued, what features of DnD were used, and how it affected design
decisions. All relevant code snippets are published along with detailed comments.</li>
<li><a class="reference internal" href="dnd/Moveable.html#dojo-dnd-moveable"><em>dojo.dnd.Moveable</em></a> Makes a DOM node moveable using the mouse.</li>
<li><a class="reference internal" href="../dojox/mdnd.html#dojox-mdnd"><em>dojox.mdnd</em></a> Experimental coordinates based moveable drag and drop.</li>
</ul>
</div>
</div>


                        </div>
                    </div>
                    <div class="sidebar unit size1of4 lastUnit">
                        <h4>Reference Guide</h4>
						<div id="dtkVersion">
							<label for="refver">Dojo Version</label>
							<select id="refver" name="refver">
								<option value="1.6">1.6</option>
								<option value="1.7">1.7</option>
								<option value="1.8" selected="selected">1.8</option>
                                <option value="1.9">1.9</option>
							</select>
						</div>
                        <ul>
                            <li><a href="../index.html">Startpage</a></li>
                            <li><a href="index.html">Dojo</a></li>
                            <li><a href="../dijit/index.html">Dijit</a></li>
                            <li><a href="../dojox/index.html">DojoX</a></li>
                        </ul>
                        
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">dojo/dnd</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#user-interface">User interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dojo-dnd-principals">dojo/dnd Principals</a><ul>
<li><a class="reference internal" href="#container">Container</a><ul>
<li><a class="reference internal" href="#constructor">Constructor</a></li>
<li><a class="reference internal" href="#default-creator">Default creator</a></li>
<li><a class="reference internal" href="#public-methods-and-attributes">Public methods and attributes</a></li>
<li><a class="reference internal" href="#event-processors">Event processors</a></li>
<li><a class="reference internal" href="#css-classes">CSS classes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#selector">Selector</a><ul>
<li><a class="reference internal" href="#id2">Constructor</a></li>
<li><a class="reference internal" href="#id3">Public methods and attributes</a></li>
<li><a class="reference internal" href="#id4">Event processors</a></li>
<li><a class="reference internal" href="#id5">CSS classes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source">Source</a><ul>
<li><a class="reference internal" href="#id6">Constructor</a></li>
<li><a class="reference internal" href="#id7">Public methods and attributes</a></li>
<li><a class="reference internal" href="#id8">Event processors</a></li>
<li><a class="reference internal" href="#topic-processors">Topic processors</a></li>
<li><a class="reference internal" href="#id9">CSS classes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#target">Target</a></li>
<li><a class="reference internal" href="#autosource">AutoSource</a></li>
<li><a class="reference internal" href="#avatar">Avatar</a><ul>
<li><a class="reference internal" href="#id10">CSS classes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manager">Manager</a><ul>
<li><a class="reference internal" href="#id11">Public methods and attributes</a></li>
<li><a class="reference internal" href="#id12">Event processors</a></li>
<li><a class="reference internal" href="#id13">Topic processors</a></li>
<li><a class="reference internal" href="#id14">CSS classes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#dojo-dnd-move-principals">dojo/dnd/move Principals</a><ul>
<li><a class="reference internal" href="#moveable">Moveable</a><ul>
<li><a class="reference internal" href="#id15">Constructor</a></li>
<li><a class="reference internal" href="#id16">Public methods and attributes</a></li>
<li><a class="reference internal" href="#id17">Event processors</a></li>
<li><a class="reference internal" href="#id18">Topic processors</a></li>
<li><a class="reference internal" href="#id19">CSS classes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mover">Mover</a><ul>
<li><a class="reference internal" href="#id20">Constructor</a></li>
<li><a class="reference internal" href="#id21">Public methods and attributes</a></li>
<li><a class="reference internal" href="#id22">Event processors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specialized-moveables">Specialized Moveables</a><ul>
<li><a class="reference internal" href="#constrainedmoveable">constrainedMoveable</a></li>
<li><a class="reference internal" href="#boxconstrainedmoveable">boxConstrainedMoveable</a></li>
<li><a class="reference internal" href="#parentconstrainedmoveable">parentConstrainedMoveable</a></li>
<li><a class="reference internal" href="#timedmoveable">TimedMoveable</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#subclassing-dnd-classes">Subclassing DnD classes</a></li>
<li><a class="reference internal" href="#summary-of-css-classes">Summary of CSS classes</a><ul>
<li><a class="reference internal" href="#body">body</a></li>
<li><a class="reference internal" href="#source-target-dojo-dnd">Source/target (dojo/dnd)</a></li>
<li><a class="reference internal" href="#dnd-item-dojo-dnd">DnD Item (dojo/dnd)</a></li>
<li><a class="reference internal" href="#dnd-handles-dojo-dnd">DnD Handles (dojo/dnd)</a></li>
<li><a class="reference internal" href="#avatar-dojo-dnd">Avatar (dojo/dnd)</a></li>
<li><a class="reference internal" href="#dragged-node-dojo-dnd-move">Dragged node (dojo.dnd.move)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary-of-topics">Summary of <tt class="docutils literal"><span class="pre">topics</span></tt></a></li>
<li><a class="reference internal" href="#tips">Tips</a></li>
<li><a class="reference internal" href="#accessibility">Accessibility</a><ul>
<li><a class="reference internal" href="#low-vision">Low Vision</a></li>
</ul>
</li>
<li><a class="reference internal" href="#see-also">See also</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="disconnect.html"
                        title="previous chapter">dojo.disconnect</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dnd/Moveable.html"
                        title="next chapter">dojo/dnd/Moveable</a></p>
    <div id="searchbox" style="display: none">
        <h3>Quick search</h3>
        <form class="search" action="../search.html" method="get">
            <input type="text" name="q" size="18" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
         </form>
         <p class="searchtip" style="font-size: 90%">
             Enter search terms or a module, class or function name.
         </p>
    </div>
        </div>
      </div>
                    </div>
                </div>
            </div>
        </div>
        <hr class="hide" />
        <div id="foot">
            <div class="innerBox">
                <script type="text/javascript">document.write('<a href="https://docs.google.com/spreadsheet/viewform?hl=en_US&amp;formkey=dFlDcHEyaHMwbEd4MFBObkNrX0E1MFE6MQ&amp;entry_0=' + encodeURIComponent(window.location.href) + '">Error in the documentation? Can’t find what you are looking for? Let us know!</a>');</script>
                <div class="footer">
                      &copy; Copyright 2005-2012, Dojo Foundation.
                      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
                </div>
            </div>  
        </div>
        <script src="http://www.google.com/jsapi?key=ABQIAAAAbTW5DVaTIHKHQe5Q75sB0BSaOaO_TgJ5c3mtQFnk5JO2zD5dZBSGHlRJ8HAPlCQCEO_FxSmyNAHSLw" type="text/javascript"></script>
    </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>